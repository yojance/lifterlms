!function(l){window.llms=window.llms||{},window.llms.checkout=new function(){var m=[],s=[];return this.$checkout_form=l("#llms-product-purchase-form"),this.$confirm_form=l("#llms-product-purchase-confirm-form"),this.$form_sections=!1,this.form_action=!1,this.init=function(){var t=this;this.$checkout_form.length?(this.form_action="checkout",this.$form_sections=this.$checkout_form.find(".llms-checkout-section"),this.$checkout_form.on("submit",this,this.submit),l(".llms-password-strength-meter").length&&this.add_before_submit_event({data:LLMS.PasswordStrength,handler:LLMS.PasswordStrength.checkout}),this.bind_login(),this.bind_coupon(),this.bind_gateways()):this.$confirm_form.length&&(this.form_action="confirm",this.$form_sections=this.$confirm_form.find(".llms-checkout-section"),this.$confirm_form.on("submit",function(){t.processing("start")}))},this.add_before_submit_event=function(t){t.handler&&"function"==typeof t.handler&&(t.data||(t.data=null),m.push(t))},this.add_error=function(t,e){var s="llms-checkout-errors";$err=l("#"+s),$err.length||($err=l('<ul class="llms-notice llms-error" id="'+s+'" />'),l(".llms-checkout-wrapper").prepend($err)),$err.append("<li>"+t+"</li>"),e&&console.error(e)},this.add_gateway=function(t){s.push(t)},this.bind_coupon=function(){var e=this;l('a[href="#llms-coupon-toggle"]').on("click",function(t){t.preventDefault(),l(".llms-coupon-entry").slideToggle(400)}),l("#llms-apply-coupon").on("click",function(t){t.preventDefault(),e.coupon_apply(l(this))}),l("#llms-remove-coupon").on("click",function(t){t.preventDefault(),e.coupon_remove(l(this))})},this.bind_gateways=function(){this.load_gateways(),l('input[name="llms_payment_gateway"]').length||l("#llms_create_pending_order").removeAttr("disabled"),l('input[name="llms_payment_gateway"]').on("change",function(){l('input[name="llms_payment_gateway"]').each(function(){var t=l(this),e=t.closest(".llms-payment-gateway"),s=e.find(".llms-gateway-fields").find("input, textarea, select"),o=t.is(":checked");e[o?"addClass":"removeClass"]("is-selected"),o?(s.removeAttr("disabled"),l(".llms-payment-gateways").trigger("llms-gateway-selected",{id:t.val(),$selector:e})):s.attr("disabled","disabled")})}),l(".llms-payment-gateways").on("llms-gateway-selected",function(t,e){var s=l("#llms_create_pending_order");e.$selector&&e.$selector.find(".llms-gateway-fields .invalid").length?s.attr("disabled","disabled"):s.removeAttr("disabled")})},this.bind_login=function(){l('a[href="#llms-show-login"]').on("click",function(t){t.preventDefault(),l(this).closest(".llms-info").slideUp(400),l("form.llms-login").slideDown(400)})},this.clear_errors=function(){l("#llms-checkout-errors").remove()},this.coupon_apply=function(t){var s=this,e=l("#llms_coupon_code").val(),o=l(".llms-coupon-messages"),n=o.find(".llms-error"),i=l("form.llms-checkout");LLMS.Spinner.start(i),window.LLMS.Ajax.call({data:{action:"validate_coupon_code",code:e,plan_id:l("#llms-plan-id").val()},beforeSend:function(){n.hide()},success:function(t){if(LLMS.Spinner.stop(i),"error"===t.code){var e=l("<li>"+t.message+"</li>");n.length?n.empty():(n=l('<ul class="llms-notice llms-error" />'),o.append(n)),e.appendTo(n),n.show()}else t.success&&(l(".llms-coupon-wrapper").replaceWith(t.data.coupon_html),s.bind_coupon(),l(".llms-payment-gateways").replaceWith(t.data.gateways_html),s.bind_gateways(),l(".llms-order-summary").replaceWith(t.data.summary_html))}})},this.coupon_remove=function(t){var e=this,s=l("form.llms-checkout");LLMS.Spinner.start(s),window.LLMS.Ajax.call({data:{action:"remove_coupon_code",plan_id:l("#llms-plan-id").val()},success:function(t){LLMS.Spinner.stop(s),t.success&&(l(".llms-coupon-wrapper").replaceWith(t.data.coupon_html),e.bind_coupon(),l(".llms-order-summary").replaceWith(t.data.summary_html),l(".llms-payment-gateways").replaceWith(t.data.gateways_html),e.bind_gateways())}})},this.focus_errors=function(){l("html, body").animate({scrollTop:l("#llms-checkout-errors").offset().top-50},200)},this.load_gateways=function(){for(var t=0;t<=s.length;t++){var e=s[t];"object"==typeof e&&null!==e&&void 0!==e.bind&&"function"==typeof e.bind&&e.bind()}},this.processing=function(t){var e,s;switch(t){case"stop":e="removeClass";break;case"start":default:e="addClass"}"checkout"===this.form_action?s=this.$checkout_form:"confirm"===this.form_action&&(s=this.$confirm_form),s[e]("llms-is-processing"),LLMS.Spinner[t](this.$form_sections)},this.submit=function(t){var o,n=t.data,i=m.length,l=0,r=[],a=0,c=0;t.preventDefault(),n.processing("start"),n.clear_errors();for(var e=0;e<m.length;e++){var s=m[e];s.handler(s.data,function(t){a++,!0===t?c++:"string"==typeof t&&r.push(t)})}o=setInterval(function(){var t=!1,e=!1;if(6e4<=l)e=t=!0;else if(i===a)if(i===c)t=!0,n.$checkout_form.off("submit",n.submit),n.$checkout_form.trigger("submit");else if(r.length){e=t=!0;for(var s=0;s<r.length;s++)n.add_error(r[s]);n.focus_errors()}t&&clearInterval(o),e&&n.processing("stop"),l++},100)},this.init(),this}}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtZm9ybS1jaGVja291dC5qcyJdLCJuYW1lcyI6WyIkIiwid2luZG93IiwibGxtcyIsImNoZWNrb3V0IiwiYmVmb3JlX3N1Ym1pdCIsImdhdGV3YXlzIiwidGhpcyIsIiRjaGVja291dF9mb3JtIiwiJGNvbmZpcm1fZm9ybSIsIiRmb3JtX3NlY3Rpb25zIiwiZm9ybV9hY3Rpb24iLCJpbml0Iiwic2VsZiIsImxlbmd0aCIsImZpbmQiLCJvbiIsInN1Ym1pdCIsImFkZF9iZWZvcmVfc3VibWl0X2V2ZW50IiwiZGF0YSIsIkxMTVMiLCJQYXNzd29yZFN0cmVuZ3RoIiwiaGFuZGxlciIsImJpbmRfbG9naW4iLCJiaW5kX2NvdXBvbiIsImJpbmRfZ2F0ZXdheXMiLCJwcm9jZXNzaW5nIiwib2JqIiwicHVzaCIsImFkZF9lcnJvciIsIm1lc3NhZ2UiLCJpZCIsIiRlcnIiLCJwcmVwZW5kIiwiYXBwZW5kIiwiY29uc29sZSIsImVycm9yIiwiYWRkX2dhdGV3YXkiLCJnYXRld2F5X2NsYXNzIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic2xpZGVUb2dnbGUiLCJjb3Vwb25fYXBwbHkiLCJjb3Vwb25fcmVtb3ZlIiwibG9hZF9nYXRld2F5cyIsInJlbW92ZUF0dHIiLCJlYWNoIiwiJGVsIiwiJHBhcmVudCIsImNsb3Nlc3QiLCIkZmllbGRzIiwiY2hlY2tlZCIsImlzIiwidHJpZ2dlciIsInZhbCIsIiRzZWxlY3RvciIsImF0dHIiLCIkc3VibWl0Iiwic2xpZGVVcCIsInNsaWRlRG93biIsImNsZWFyX2Vycm9ycyIsInJlbW92ZSIsIiRidG4iLCJjb2RlIiwiJG1lc3NhZ2VzIiwiJGVycm9ycyIsIiRjb250YWluZXIiLCJTcGlubmVyIiwic3RhcnQiLCJBamF4IiwiY2FsbCIsImFjdGlvbiIsInBsYW5faWQiLCJiZWZvcmVTZW5kIiwiaGlkZSIsInN1Y2Nlc3MiLCJyIiwic3RvcCIsIiRtZXNzYWdlIiwiZW1wdHkiLCJhcHBlbmRUbyIsInNob3ciLCJyZXBsYWNlV2l0aCIsImNvdXBvbl9odG1sIiwiZ2F0ZXdheXNfaHRtbCIsInN1bW1hcnlfaHRtbCIsImZvY3VzX2Vycm9ycyIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJvZmZzZXQiLCJ0b3AiLCJpIiwiZyIsInVuZGVmaW5lZCIsImJpbmQiLCJmdW5jIiwiJGZvcm0iLCJpbnRlcnZhbCIsIm51bSIsImNoZWNrcyIsImVycm9ycyIsImZpbmlzaGVzIiwic3VjY2Vzc2VzIiwic2V0SW50ZXJ2YWwiLCJjbGVhciIsIm9mZiIsImNsZWFySW50ZXJ2YWwiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQU1DLFNBQVlBLEdBaWlCWkMsT0FBT0MsS0FBT0QsT0FBT0MsTUFBUSxHQUM3QkQsT0FBT0MsS0FBS0MsU0FBVyxJQWhpQkgsV0FRbkIsSUFBSUMsRUFBZ0IsR0FRaEJDLEVBQVcsR0EyZ0JmLE9BemdCQUMsS0FBS0MsZUFBaUJQLEVBQUcsK0JBQ3pCTSxLQUFLRSxjQUFnQlIsRUFBRyx1Q0FDeEJNLEtBQUtHLGdCQUFpQixFQUN0QkgsS0FBS0ksYUFBYyxFQVFuQkosS0FBS0ssS0FBTyxXQUVYLElBQUlDLEVBQU9OLEtBRU5BLEtBQUtDLGVBQWVNLFFBRXhCUCxLQUFLSSxZQUFjLFdBQ25CSixLQUFLRyxlQUFpQkgsS0FBS0MsZUFBZU8sS0FBTSwwQkFFaERSLEtBQUtDLGVBQWVRLEdBQUksU0FBVVQsS0FBTUEsS0FBS1UsUUFHeENoQixFQUFHLGlDQUFrQ2EsUUFDekNQLEtBQUtXLHdCQUF5QixDQUM3QkMsS0FBTUMsS0FBS0MsaUJBQ1hDLFFBQVNGLEtBQUtDLGlCQUFpQmpCLFdBSWpDRyxLQUFLZ0IsYUFFTGhCLEtBQUtpQixjQUVMakIsS0FBS2tCLGlCQUVNbEIsS0FBS0UsY0FBY0ssU0FFOUJQLEtBQUtJLFlBQWMsVUFDbkJKLEtBQUtHLGVBQWlCSCxLQUFLRSxjQUFjTSxLQUFNLDBCQUUvQ1IsS0FBS0UsY0FBY08sR0FBSSxTQUFVLFdBQ2hDSCxFQUFLYSxXQUFZLGFBZ0JwQm5CLEtBQUtXLHdCQUEwQixTQUFV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LGNBQWVULEdBR1hwQixHQUNKaEUsRUFBS2EsV0FBWSxRQUlsQnlFLEtBRUUsTUFLSjVGLEtBQUtLLE9BRUVMLE1BN2hCUixDQW9pQklvRyIsImZpbGUiOiJsbG1zLWZvcm0tY2hlY2tvdXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWZ0ZXJMTVMgQ2hlY2tvdXQgU2NyZWVuIHJlbGF0ZWQgZXZlbnRzIGFuZCBpbnRlcmFjdGlvbnNcbiAqXG4gKiBAc2luY2UgICAgMy4wLjBcbiAqIEB2ZXJzaW9uICAzLjI3LjBcbiAqL1xuOyggZnVuY3Rpb24oICQgKSB7XG5cblx0dmFyIGxsbXNfY2hlY2tvdXQgPSBmdW5jdGlvbigpIHtcblxuXHRcdC8qKlxuXHRcdCAqIEFycmF5IG9mIHZhbGlkYXRpb24gZnVuY3Rpb25zIHRvIGNhbGwgb24gZm9ybSBzdWJtaXNzaW9uXG5cdFx0ICogQHR5cGUgICAgYXJyYXlcblx0XHQgKiBAc2luY2UgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMC4wXG5cdFx0ICovXG5cdFx0dmFyIGJlZm9yZV9zdWJtaXQgPSBbXTtcblxuXHRcdC8qKlxuXHRcdCAqIEFycmF5IG9mIGdhdGV3YXlzIHRvIGJlIGF1dG9tYXRpY2FsbHkgYm91bmQgd2hlbiBuZWVkZWRcblx0XHQgKiBAdHlwZSAgICBhcnJheVxuXHRcdCAqIEBzaW5jZSAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gMy4wLjBcblx0XHQgKi9cblx0XHR2YXIgZ2F0ZXdheXMgPSBbXTtcblxuXHRcdHRoaXMuJGNoZWNrb3V0X2Zvcm0gPSAkKCAnI2xsbXMtcHJvZHVjdC1wdXJjaGFzZS1mb3JtJyApO1xuXHRcdHRoaXMuJGNvbmZpcm1fZm9ybSA9ICQoICcjbGxtcy1wcm9kdWN0LXB1cmNoYXNlLWNvbmZpcm0tZm9ybScgKTtcblx0XHR0aGlzLiRmb3JtX3NlY3Rpb25zID0gZmFsc2U7XG5cdFx0dGhpcy5mb3JtX2FjdGlvbiA9IGZhbHNlO1xuXG5cdFx0LyoqXG5cdFx0ICogSW5pdGFsaXplIGNoZWNrb3V0IEpTICYgYmluZCBpZiBvbiB0aGUgY2hlY2tvdXQgc2NyZWVuXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4yNC4xXG5cdFx0ICovXG5cdFx0dGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0aWYgKCB0aGlzLiRjaGVja291dF9mb3JtLmxlbmd0aCApIHtcblxuXHRcdFx0XHR0aGlzLmZvcm1fYWN0aW9uID0gJ2NoZWNrb3V0Jztcblx0XHRcdFx0dGhpcy4kZm9ybV9zZWN0aW9ucyA9IHRoaXMuJGNoZWNrb3V0X2Zvcm0uZmluZCggJy5sbG1zLWNoZWNrb3V0LXNlY3Rpb24nICk7XG5cblx0XHRcdFx0dGhpcy4kY2hlY2tvdXRfZm9ybS5vbiggJ3N1Ym1pdCcsIHRoaXMsIHRoaXMuc3VibWl0ICk7XG5cblx0XHRcdFx0Ly8gYWRkIGJlZm9yZSBzdWJtaXQgZXZlbnQgZm9yIHBhc3N3b3JkIHN0cmVuZ3RoIG1ldGVyIGlmIG9uZSdzIGZvdW5kXG5cdFx0XHRcdGlmICggJCggJy5sbG1zLXBhc3N3b3JkLXN0cmVuZ3RoLW1ldGVyJyApLmxlbmd0aCApIHtcblx0XHRcdFx0XHR0aGlzLmFkZF9iZWZvcmVfc3VibWl0X2V2ZW50KCB7XG5cdFx0XHRcdFx0XHRkYXRhOiBMTE1TLlBhc3N3b3JkU3RyZW5ndGgsXG5cdFx0XHRcdFx0XHRoYW5kbGVyOiBMTE1TLlBhc3N3b3JkU3RyZW5ndGguY2hlY2tvdXQsXG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5iaW5kX2xvZ2luKCk7XG5cblx0XHRcdFx0dGhpcy5iaW5kX2NvdXBvbigpO1xuXG5cdFx0XHRcdHRoaXMuYmluZF9nYXRld2F5cygpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCB0aGlzLiRjb25maXJtX2Zvcm0ubGVuZ3RoICkge1xuXG5cdFx0XHRcdHRoaXMuZm9ybV9hY3Rpb24gPSAnY29uZmlybSc7XG5cdFx0XHRcdHRoaXMuJGZvcm1fc2VjdGlvbnMgPSB0aGlzLiRjb25maXJtX2Zvcm0uZmluZCggJy5sbG1zLWNoZWNrb3V0LXNlY3Rpb24nICk7XG5cblx0XHRcdFx0dGhpcy4kY29uZmlybV9mb3JtLm9uKCAnc3VibWl0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0c2VsZi5wcm9jZXNzaW5nKCAnc3RhcnQnICk7XG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFB1YmxpYyBmdW5jdGlvbiB3aGljaCBhbGxvd3Mgb3RoZXIgY2xhc3NlcyBvciBleHRlbnNpb25zIHRvIGFkZFxuXHRcdCAqIGJlZm9yZSBzdWJtaXQgZXZlbnRzIHRvIGxsbXMgY2hlY2tvdXQgcHJpdmF0ZSBcImJlZm9yZV9zdWJtaXRcIiBhcnJheVxuXHRcdCAqIEBwYXJhbSAgICBvYmplY3QgIG9iaiAgb2JqZWN0IG9mIGRhdGEgdG8gcHVzaCB0byB0aGUgYXJyYXlcblx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzIGF0IGxlYXN0IGEgXCJoYW5kbGVyXCIga2V5IHdoaWNoIHNob3VsZCBwYXNzIGEgY2FsbGFibGUgZnVuY3Rpb25cblx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVwiIGNhbiBiZSBhbnl0aGluZywgd2lsbCBiZSBwYXNzZWQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlciB0byB0aGUgaGFuZGxlciBmdW5jdGlvblxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYWRkX2JlZm9yZV9zdWJtaXRfZXZlbnQgPSBmdW5jdGlvbiggb2JqICkge1xuXG5cdFx0XHRpZiAoICFvYmouaGFuZGxlciB8fCAnZnVuY3Rpb24nICE9PSB0eXBlb2Ygb2JqLmhhbmRsZXIgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhb2JqLmRhdGEgKSB7XG5cdFx0XHRcdG9iai5kYXRhID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0YmVmb3JlX3N1Ym1pdC5wdXNoKCBvYmogKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBBZGQgYW4gZXJyb3IgbWVzc2FnZVxuXHRcdCAqIEBwYXJhbSAgICBzdHJpbmcgICAgIG1lc3NhZ2UgIGVycm9yIG1lc3NhZ2Ugc3RyaW5nXG5cdFx0ICogQHBhcmFtICAgIG1peGVkICAgICAgZGF0YSAgICAgb3B0aW9uYWwgZXJyb3IgZGF0YSB0byBvdXRwdXQgb24gdGhlIGNvbnNvbGVcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjI3LjBcblx0XHQgKiBAdmVyc2lvbiAgMy4yNy4wXG5cdFx0ICovXG5cdFx0dGhpcy5hZGRfZXJyb3IgPSBmdW5jdGlvbiggbWVzc2FnZSwgZGF0YSApIHtcblxuXHRcdFx0dmFyIGlkID0gJ2xsbXMtY2hlY2tvdXQtZXJyb3JzJztcblx0XHRcdFx0JGVyciA9ICQoICcjJyArIGlkICk7XG5cblx0XHRcdGlmICggISAkZXJyLmxlbmd0aCApIHtcblx0XHRcdFx0JGVyciA9ICQoICc8dWwgY2xhc3M9XCJsbG1zLW5vdGljZSBsbG1zLWVycm9yXCIgaWQ9XCInICsgaWQgKyAnXCIgLz4nICk7XG5cdFx0XHRcdCQoICcubGxtcy1jaGVja291dC13cmFwcGVyJyApLnByZXBlbmQoICRlcnIgKTtcblx0XHRcdH1cblxuXHRcdFx0JGVyci5hcHBlbmQoICc8bGk+JyArIG1lc3NhZ2UgKyAnPC9saT4nICk7XG5cblx0XHRcdGlmICggZGF0YSApIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvciggZGF0YSApO1xuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFB1YmxpYyBmdW5jdGlvbiB3aGljaCBhbGxvd3Mgb3RoZXIgY2xhc3NlcyBvciBleHRlbnNpb25zIHRvIGFkZFxuXHRcdCAqIGdhdGV3YXlzIGNsYXNzZXMgdGhhdCBzaG91bGQgYmUgYm91bmQgYnkgdGhpcyBjbGFzc1xuXHRcdCAqIEBwYXJhbSAgICBvYmogICBnYXRld2F5X2NsYXNzICBjYWxsYWJsZSBjbGFzcyBvYmplY3Rcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLmFkZF9nYXRld2F5ID0gZnVuY3Rpb24oIGdhdGV3YXlfY2xhc3MgKSB7XG5cblx0XHRcdGdhdGV3YXlzLnB1c2goIGdhdGV3YXlfY2xhc3MgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIGNvdXBvbiBhZGQgJiByZW1vdmUgYnV0dG9uIGV2ZW50c1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kX2NvdXBvbiA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdC8vIHNob3cgJiBoaWRlIHRoZSBjb3Vwb24gZmllbGQgJiBidXR0b25cblx0XHRcdCQoICdhW2hyZWY9XCIjbGxtcy1jb3Vwb24tdG9nZ2xlXCJdJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCQoICcubGxtcy1jb3Vwb24tZW50cnknICkuc2xpZGVUb2dnbGUoIDQwMCApO1xuXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIGFwcGx5IGNvdXBvbiBjbGlja1xuXHRcdFx0JCggJyNsbG1zLWFwcGx5LWNvdXBvbicgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRzZWxmLmNvdXBvbl9hcHBseSggJCggdGhpcyApICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGNvdXBvbiBjbGlja1xuXHRcdFx0JCggJyNsbG1zLXJlbW92ZS1jb3Vwb24nICkub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0c2VsZi5jb3Vwb25fcmVtb3ZlKCAkKCB0aGlzICkgKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEJpbmQgZ2F0ZXdheSBzZWN0aW9uIGV2ZW50c1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kX2dhdGV3YXlzID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHRoaXMubG9hZF9nYXRld2F5cygpO1xuXG5cdFx0XHRpZiAoICEgJCggJ2lucHV0W25hbWU9XCJsbG1zX3BheW1lbnRfZ2F0ZXdheVwiXScpLmxlbmd0aCApIHtcblx0XHRcdFx0JCggJyNsbG1zX2NyZWF0ZV9wZW5kaW5nX29yZGVyJyApLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gYWRkIGNsYXNzIGFuZCB0cmlnZ2VyIHdhdGNoYWJsZSBldmVudCB3aGVuIGdhdGV3YXkgc2VsZWN0aW9uIGNoYW5nZXNcblx0XHRcdCQoICdpbnB1dFtuYW1lPVwibGxtc19wYXltZW50X2dhdGV3YXlcIl0nICkub24oICdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcblxuIFx0XHRcdFx0JCggJ2lucHV0W25hbWU9XCJsbG1zX3BheW1lbnRfZ2F0ZXdheVwiXScgKS5lYWNoKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHRcdHZhciAkZWwgPSAkKCB0aGlzICksXG5cdFx0XHRcdFx0XHQkcGFyZW50ID0gJGVsLmNsb3Nlc3QoICcubGxtcy1wYXltZW50LWdhdGV3YXknICksXG5cdFx0XHRcdFx0XHQkZmllbGRzID0gJHBhcmVudC5maW5kKCAnLmxsbXMtZ2F0ZXdheS1maWVsZHMnICkuZmluZCggJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0JyApLFxuXHRcdFx0XHRcdFx0Y2hlY2tlZCA9ICRlbC5pcyggJzpjaGVja2VkJyApLFxuXHRcdFx0XHRcdFx0ZGlzcGxheV9mdW5jID0gKCBjaGVja2VkICkgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJztcblxuXHRcdFx0XHRcdCRwYXJlbnRbIGRpc3BsYXlfZnVuYyBdKCAnaXMtc2VsZWN0ZWQnICk7XG5cblx0XHRcdFx0XHRpZiAoIGNoZWNrZWQgKSB7XG5cblx0XHRcdFx0XHRcdC8vIGVuYWJsZSBmaWVsZHNcblx0XHRcdFx0XHRcdCRmaWVsZHMucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApO1xuXG5cdFx0XHRcdFx0XHQvLyBlbWl0IGEgd2F0Y2hhYmxlIGV2ZW50IGZvciBleHRlbnNpb25zIHRvIGhvb2sgb250b1xuXHRcdFx0XHRcdFx0JCggJy5sbG1zLXBheW1lbnQtZ2F0ZXdheXMnICkudHJpZ2dlciggJ2xsbXMtZ2F0ZXdheS1zZWxlY3RlZCcsIHtcblx0XHRcdFx0XHRcdFx0aWQ6ICRlbC52YWwoKSxcblx0XHRcdFx0XHRcdFx0JHNlbGVjdG9yOiAkcGFyZW50LFxuXHRcdFx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0Ly8gZGlzYWJsZSBmaWVsZHNcblx0XHRcdFx0XHRcdCRmaWVsZHMuYXR0ciggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBlbmFibGUgLyBkaXNhYmxlIGJ1dHRvbnMgZGVwZW5kaW5nIG9uIGZpZWxkIHZhbGlkYXRpb24gc3RhdHVzXG5cdFx0XHQkKCAnLmxsbXMtcGF5bWVudC1nYXRld2F5cycgKS5vbiggJ2xsbXMtZ2F0ZXdheS1zZWxlY3RlZCcsIGZ1bmN0aW9uKCBlLCBkYXRhICkge1xuXG5cdFx0XHRcdHZhciAkc3VibWl0ID0gJCggJyNsbG1zX2NyZWF0ZV9wZW5kaW5nX29yZGVyJyApO1xuXG5cdFx0XHRcdGlmICggZGF0YS4kc2VsZWN0b3IgJiYgZGF0YS4kc2VsZWN0b3IuZmluZCggJy5sbG1zLWdhdGV3YXktZmllbGRzIC5pbnZhbGlkJyApLmxlbmd0aCApIHtcblx0XHRcdFx0XHQkc3VibWl0LmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkc3VibWl0LnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBjbGljayBldmVudHMgZm9yIHRoZSBTaG93IC8gSGlkZSBsb2dpbiBhcmVhIGF0IHRoZSB0b3Agb2YgdGhlIGNoZWNrb3V0IHNjcmVlblxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kX2xvZ2luID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdCQoICdhW2hyZWY9XCIjbGxtcy1zaG93LWxvZ2luXCJdJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCQoIHRoaXMgKS5jbG9zZXN0KCAnLmxsbXMtaW5mbycgKS5zbGlkZVVwKCA0MDAgKTtcblx0XHRcdFx0JCggJ2Zvcm0ubGxtcy1sb2dpbicgKS5zbGlkZURvd24oIDQwMCApO1xuXG5cdFx0XHR9ICk7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIENsZWFyIGVycm9yIG1lc3NhZ2VzXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4yNy4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjcuMFxuXHRcdCAqL1xuXHRcdHRoaXMuY2xlYXJfZXJyb3JzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCAnI2xsbXMtY2hlY2tvdXQtZXJyb3JzJyApLnJlbW92ZSgpO1xuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBUcmlnZ2VyZWQgYnkgY2xpY2tpbmcgdGhlIFwiQXBwbHkgQ291cG9uXCIgQnV0dG9uXG5cdFx0ICogVmFsaWRhdGVzIHRoZSBjb3Vwb24gdmlhIEpTIGFuZCBhZGRzIGVycm9yIC8gc3VjY2VzcyBtZXNzYWdlc1xuXHRcdCAqIE9uIHN1Y2Nlc3MgaXQgd2lsbCByZXBsYWNlIHBhcnRpYWxzIG9uIHRoZSBjaGVja291dCBzY3JlZW4gd2l0aCB1cGRhdGVkXG5cdFx0ICogcHJpY2VzIGFuZCBhIFwicmVtb3ZlIGNvdXBvblwiIGJ1dHRvblxuXHRcdCAqIEBwYXJhbSAgICBvYmogICAkYnRuICBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIEFwcGx5IGJ1dHRvblxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5jb3Vwb25fYXBwbHkgPSBmdW5jdGlvbiAoICRidG4gKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0JGNvZGUgPSAkKCAnI2xsbXNfY291cG9uX2NvZGUnICksXG5cdFx0XHRcdGNvZGUgPSAkY29kZS52YWwoKSxcblx0XHRcdFx0JG1lc3NhZ2VzID0gJCggJy5sbG1zLWNvdXBvbi1tZXNzYWdlcycgKSxcblx0XHRcdFx0JGVycm9ycyA9ICRtZXNzYWdlcy5maW5kKCAnLmxsbXMtZXJyb3InICksXG5cdFx0XHRcdCRjb250YWluZXIgPSAkKCAnZm9ybS5sbG1zLWNoZWNrb3V0JyApO1xuXG5cdFx0XHRMTE1TLlNwaW5uZXIuc3RhcnQoICRjb250YWluZXIgKTtcblxuXHRcdFx0d2luZG93LkxMTVMuQWpheC5jYWxsKCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICd2YWxpZGF0ZV9jb3Vwb25fY29kZScsXG5cdFx0XHRcdFx0Y29kZTogY29kZSxcblx0XHRcdFx0XHRwbGFuX2lkOiAkKCAnI2xsbXMtcGxhbi1pZCcgKS52YWwoKSxcblx0XHRcdFx0fSxcblx0XHRcdFx0YmVmb3JlU2VuZDogZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0XHQkZXJyb3JzLmhpZGUoKTtcblxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggciApIHtcblxuXHRcdFx0XHRcdExMTVMuU3Bpbm5lci5zdG9wKCAkY29udGFpbmVyICk7XG5cblx0XHRcdFx0XHRpZiAoICdlcnJvcicgPT09IHIuY29kZSApIHtcblxuXHRcdFx0XHRcdFx0dmFyICRtZXNzYWdlID0gJCggJzxsaT4nICsgci5tZXNzYWdlICsgJzwvbGk+Jyk7XG5cblx0XHRcdFx0XHRcdGlmICggISAkZXJyb3JzLmxlbmd0aCApIHtcblxuXHRcdFx0XHRcdFx0XHQkZXJyb3JzID0gJCggJzx1bCBjbGFzcz1cImxsbXMtbm90aWNlIGxsbXMtZXJyb3JcIiAvPicgKTtcblx0XHRcdFx0XHRcdFx0JG1lc3NhZ2VzLmFwcGVuZCggJGVycm9ycyApO1xuXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0XHRcdCRlcnJvcnMuZW1wdHkoKTtcblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQkbWVzc2FnZS5hcHBlbmRUbyggJGVycm9ycyApO1xuXHRcdFx0XHRcdFx0JGVycm9ycy5zaG93KCk7XG5cblx0XHRcdFx0XHR9IGVsc2UgaWYgKCByLnN1Y2Nlc3MgKSB7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1jb3Vwb24td3JhcHBlcicgKS5yZXBsYWNlV2l0aCggci5kYXRhLmNvdXBvbl9odG1sICk7XG5cdFx0XHRcdFx0XHRzZWxmLmJpbmRfY291cG9uKCk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1wYXltZW50LWdhdGV3YXlzJyApLnJlcGxhY2VXaXRoKCByLmRhdGEuZ2F0ZXdheXNfaHRtbCApO1xuXHRcdFx0XHRcdFx0c2VsZi5iaW5kX2dhdGV3YXlzKCk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1vcmRlci1zdW1tYXJ5JyApLnJlcGxhY2VXaXRoKCByLmRhdGEuc3VtbWFyeV9odG1sICk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQ2FsbGVkIGJ5IGNsaWNraW5nIHRoZSBcIlJlbW92ZSBDb3Vwb25cIiBidXR0b25cblx0XHQgKiBSZW1vdmVzIHRoZSBjb3Vwb24gdmlhIEFKQVggYW5kIHVuc2V0cyByZWxhdGVkIHNlc3Npb24gZGF0YVxuXHRcdCAqIEBwYXJhbSAgICBvYmogICAkYnRuICBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIFJlbW92ZSBidXR0b25cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuY291cG9uX3JlbW92ZSA9IGZ1bmN0aW9uKCAkYnRuICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdCRjb250YWluZXIgPSAkKCAnZm9ybS5sbG1zLWNoZWNrb3V0JyApO1xuXG5cdFx0XHRMTE1TLlNwaW5uZXIuc3RhcnQoICRjb250YWluZXIgKTtcblxuXHRcdFx0d2luZG93LkxMTVMuQWpheC5jYWxsKCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICdyZW1vdmVfY291cG9uX2NvZGUnLFxuXHRcdFx0XHRcdHBsYW5faWQ6ICQoICcjbGxtcy1wbGFuLWlkJyApLnZhbCgpLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggciApIHtcblxuXHRcdFx0XHRcdExMTVMuU3Bpbm5lci5zdG9wKCAkY29udGFpbmVyICk7XG5cblx0XHRcdFx0XHRpZiAoIHIuc3VjY2VzcyApIHtcblxuXHRcdFx0XHRcdFx0JCggJy5sbG1zLWNvdXBvbi13cmFwcGVyJyApLnJlcGxhY2VXaXRoKCByLmRhdGEuY291cG9uX2h0bWwgKTtcblx0XHRcdFx0XHRcdHNlbGYuYmluZF9jb3Vwb24oKTtcblxuXHRcdFx0XHRcdFx0JCggJy5sbG1zLW9yZGVyLXN1bW1hcnknICkucmVwbGFjZVdpdGgoIHIuZGF0YS5zdW1tYXJ5X2h0bWwgKTtcblxuXHRcdFx0XHRcdFx0JCggJy5sbG1zLXBheW1lbnQtZ2F0ZXdheXMnICkucmVwbGFjZVdpdGgoIHIuZGF0YS5nYXRld2F5c19odG1sICk7XG5cdFx0XHRcdFx0XHRzZWxmLmJpbmRfZ2F0ZXdheXMoKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9XG5cblx0XHRcdH0gKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBTY3JvbGwgZXJyb3IgbWVzc2FnZXMgaW50byB2aWV3XG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4yNy4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjcuMFxuXHRcdCAqL1xuXHRcdHRoaXMuZm9jdXNfZXJyb3JzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCAnaHRtbCwgYm9keScgKS5hbmltYXRlKCB7XG5cdFx0XHRcdHNjcm9sbFRvcDogJCggJyNsbG1zLWNoZWNrb3V0LWVycm9ycycgKS5vZmZzZXQoKS50b3AgLSA1MCxcblx0XHRcdH0sIDIwMCApO1xuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIGV4dGVybmFsIGdhdGV3YXkgSlNcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMubG9hZF9nYXRld2F5cyA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPD0gZ2F0ZXdheXMubGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdHZhciBnID0gZ2F0ZXdheXNbaV07XG5cdFx0XHRcdGlmICggdHlwZW9mIGcgPT09ICdvYmplY3QnICYmIGcgIT09IG51bGwgKSB7XG5cdFx0XHRcdFx0aWYgKCBnLmJpbmQgIT09IHVuZGVmaW5lZCAmJiAnZnVuY3Rpb24nID09PSB0eXBlb2YgZy5iaW5kICApIHtcblx0XHRcdFx0XHRcdGcuYmluZCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBTdGFydCBvciBzdG9wIHByb2NjZXNzaW5nIGV2ZW50cyBvbiB0aGUgY2hlY2tvdXQgZm9ybVxuXHRcdCAqIEBwYXJhbSAgICBzdHJpbmcgICBhY3Rpb24gIHdoZXRoZXIgdG8gc3RhcnQgb3Igc3RvcCBwcm9jZXNzaW5nIFtzdGFydHxzdG9wXVxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjQuMVxuXHRcdCAqL1xuXHRcdHRoaXMucHJvY2Vzc2luZyA9IGZ1bmN0aW9uKCBhY3Rpb24gKSB7XG5cblx0XHRcdHZhciBmdW5jLCAkZm9ybTtcblxuXHRcdFx0c3dpdGNoICggYWN0aW9uICkge1xuXG5cdFx0XHRcdGNhc2UgJ3N0b3AnOlxuXHRcdFx0XHRcdGZ1bmMgPSAncmVtb3ZlQ2xhc3MnO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdzdGFydCc6XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0ZnVuYyA9ICdhZGRDbGFzcyc7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggJ2NoZWNrb3V0JyA9PT0gdGhpcy5mb3JtX2FjdGlvbiApIHtcblx0XHRcdFx0JGZvcm0gPSB0aGlzLiRjaGVja291dF9mb3JtO1xuXHRcdFx0fSBlbHNlIGlmICggJ2NvbmZpcm0nID09PSB0aGlzLmZvcm1fYWN0aW9uICkge1xuXHRcdFx0XHQkZm9ybSA9IHRoaXMuJGNvbmZpcm1fZm9ybTtcblx0XHRcdH1cblxuXHRcdFx0JGZvcm1bIGZ1bmMgXSggJ2xsbXMtaXMtcHJvY2Vzc2luZycgKTtcblx0XHRcdExMTVMuU3Bpbm5lclsgYWN0aW9uIF0oIHRoaXMuJGZvcm1fc2VjdGlvbnMgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBIYW5kbGVzIGZvcm0gc3VibWlzc2lvblxuXHRcdCAqIENhbGxzIGFsbCB2YWxpZGF0aW9uIGV2ZW50cyBpbiBgYmVmb3JlX3N1Ym1pdFtdYFxuXHRcdCAqIHdhaXRzIGZvciBjYWxsIGJhY2tzIGFuZCBlaXRoZXIgZGlzcGxheXMgcmV0dXJuZWQgZXJyb3JzXG5cdFx0ICogb3Igc3VibWl0cyB0aGUgZm9ybSB3aGVuIGFsbCBhcmUgc3VjY2VzZnVsXG5cdFx0ICogQHBhcmFtICAgIG9iaiAgIGUgIEpTIGV2ZW50IG9iamVjdFxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjcuMFxuXHRcdCAqL1xuXHRcdHRoaXMuc3VibWl0ID0gZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdHZhciBzZWxmID0gZS5kYXRhLFxuXHRcdFx0XHRudW0gPSBiZWZvcmVfc3VibWl0Lmxlbmd0aCxcblx0XHRcdFx0Y2hlY2tzID0gMCxcblx0XHRcdFx0bWF4X2NoZWNrcyA9IDYwMDAwLFxuXHRcdFx0XHRlcnJvcnMgPSBbXSxcblx0XHRcdFx0ZmluaXNoZXMgPSAwLFxuXHRcdFx0XHRzdWNjZXNzZXMgPSAwLFxuXHRcdFx0XHRpbnRlcnZhbDtcblxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHQvLyBhZGQgc3Bpbm5lcnNcblx0XHRcdHNlbGYucHJvY2Vzc2luZyggJ3N0YXJ0JyApO1xuXG5cdFx0XHQvLyByZW1vdmUgZXJyb3JzIHRvIHByZXZlbnQgZHVwbGljYXRlc1xuXHRcdFx0c2VsZi5jbGVhcl9lcnJvcnMoKTtcblxuXHRcdFx0Ly8gc3RhcnQgcnVubmluZyBhbGwgdGhlIGV2ZW50c1xuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgYmVmb3JlX3N1Ym1pdC5sZW5ndGg7IGkrKyApIHtcblxuXHRcdFx0XHR2YXIgb2JqID0gYmVmb3JlX3N1Ym1pdFsgaSBdO1xuXG5cdFx0XHRcdG9iai5oYW5kbGVyKCBvYmouZGF0YSwgZnVuY3Rpb24oIHIgKSB7XG5cblx0XHRcdFx0XHRmaW5pc2hlcysrO1xuXHRcdFx0XHRcdGlmICggdHJ1ZSA9PT0gciApIHtcblx0XHRcdFx0XHRcdHN1Y2Nlc3NlcysrO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoICdzdHJpbmcnID09PSB0eXBlb2YgciApIHtcblx0XHRcdFx0XHRcdGVycm9ycy5wdXNoKCByICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBydW4gYW4gaW50ZXJ2YWwgdG8gd2FpdCBmb3IgZmluaXNoZXNcblx0XHRcdGludGVydmFsID0gc2V0SW50ZXJ2YWwoIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciBjbGVhciA9IGZhbHNlLFxuXHRcdFx0XHRcdHN0b3AgPSBmYWxzZTtcblxuXHRcdFx0XHQvLyB0aW1lb3V0Li4uXG5cdFx0XHRcdGlmICggY2hlY2tzID49IG1heF9jaGVja3MgKSB7XG5cblx0XHRcdFx0XHRjbGVhciA9IHRydWU7XG5cdFx0XHRcdFx0c3RvcCA9IHRydWU7XG5cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBldmVyeXRoaW5nIGhhcyBmaW5pc2hlZFxuXHRcdFx0XHRlbHNlIGlmICggbnVtID09PSBmaW5pc2hlcyApIHtcblxuXHRcdFx0XHRcdC8vIGFsbCB3ZXJlIHN1Y2Nlc2Z1bCwgc3VibWl0IHRoZSBmb3JtXG5cdFx0XHRcdFx0aWYgKCBudW0gPT09IHN1Y2Nlc3NlcyApIHtcblxuXHRcdFx0XHRcdFx0Y2xlYXIgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHRzZWxmLiRjaGVja291dF9mb3JtLm9mZiggJ3N1Ym1pdCcsIHNlbGYuc3VibWl0ICk7XG5cdFx0XHRcdFx0XHRzZWxmLiRjaGVja291dF9mb3JtLnRyaWdnZXIoICdzdWJtaXQnICk7XG5cblx0XHRcdFx0XHR9IGVsc2UgaWYgKCBlcnJvcnMubGVuZ3RoICkge1xuXG5cdFx0XHRcdFx0XHRjbGVhciA9IHRydWU7XG5cdFx0XHRcdFx0XHRzdG9wID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgZXJyb3JzLmxlbmd0aDsgaSsrICkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLmFkZF9lcnJvciggZXJyb3JzWyBpIF0gKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0c2VsZi5mb2N1c19lcnJvcnMoKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCBjbGVhciApIHtcblx0XHRcdFx0XHRjbGVhckludGVydmFsKCBpbnRlcnZhbCApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCBzdG9wICkge1xuXHRcdFx0XHRcdHNlbGYucHJvY2Vzc2luZyggJ3N0b3AnICk7XG5cdFx0XHRcdH1cblxuXG5cdFx0XHRcdGNoZWNrcysrO1xuXG5cdFx0XHR9LCAxMDAgKTtcblxuXHRcdH07XG5cblx0XHQvLyBpbml0YWxpemVcblx0XHR0aGlzLmluaXQoKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH07XG5cblx0d2luZG93LmxsbXMgPSB3aW5kb3cubGxtcyB8fCB7fTtcblx0d2luZG93LmxsbXMuY2hlY2tvdXQgPSBuZXcgbGxtc19jaGVja291dCgpO1xuXG59ICkoIGpRdWVyeSApO1xuIl19
