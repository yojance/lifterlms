!function(c){window.llms=window.llms||{},window.llms.metabox_product=function(){this.$plans=null,this.$save=null,this.temp_id=Math.floor(7777*Math.random()+777),this.validation_class="llms-invalid",this.init=function(e){var t=this;t.$plans=c("#llms-access-plans"),t.$save=c("#llms-save-access-plans"),t.bind_visibility();var a=c("#lifterlms-product #llms-product-options-access-plans");if(a.length)if(e)t.bind();else{LLMS.Spinner.start(a);var l,s=0;l=setInterval(function(){if(300<=s)a.html(LLMS.l10n.translate("There was an error loading the necessary resources. Please try again."));else{if("undefined"==typeof tinyMCE)return void s++;t.bind()}clearInterval(l),LLMS.Spinner.stop(a)},100)}},this.bind=function(){var s=this;setTimeout(function(){s.has_plan_limit_been_reached()&&s.toggle_create_button("disable")},500),0===s.get_current_plan_count()&&s.toggle_save_button("disable"),s.$save.on("click",function(e){e.preventDefault(),s.save_plans()}),s.$plans.on("change","[data-controller-id]",function(){s.controller_change(c(this))}),s.$plans.on("change",'select[name$="[availability]"]',function(){var e=c(this).closest(".llms-access-plan"),t=e.find('input[name$="[checkout_redirect_forced]"]'),a=e.find(".llms-checkout-redirect-settings");"members"===c(this).val()?(t.prop("checked")?a.show():a.hide(),t.on("change",function(){a.toggle()})):(t.off("change"),a.show())}),c("#llms-access-plans .llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),c("#llms-access-plans [data-controller-id]").trigger("change"),c("#llms-new-access-plan").on("click",function(){s.init_plan(),s.toggle_create_button("disable"),s.toggle_save_button("enable"),setTimeout(function(){s.has_plan_limit_been_reached()||s.toggle_create_button("enable")},500)}),s.$plans.sortable({handle:".llms-drag-handle",items:".llms-access-plan",start:function(e,t){s.$plans.addClass("dragging")},stop:function(e,t){s.$plans.removeClass("dragging"),s.update_plan_orders()}}),s.$plans.on("keyup","input.llms-plan-title",function(){var e=c(this),t=e.closest(".llms-access-plan").find("span.llms-plan-title"),a=e.val(),l=a||t.attr("data-default");t.text(l)}),s.$plans.on("focusin","input",function(e,t){c(this).addClass("llms-has-been-focused")}),s.$plans.on("keyup focusout llms-validate-plan-field","input",function(e,t){var a=c(this);a[0].checkValidity()?a.removeClass(s.validation_class):(a.addClass(s.validation_class),"keyup"===e.type&&a[0].reportValidity()),t&&!t.cascade||a.closest(".llms-access-plan").trigger("llms-validate-plan",{original_event:e.type})}),s.$plans.on("llms-validate-plan",".llms-access-plan",function(e,t){t=t||{};var a=c(this),l=t.original_event?"input.llms-has-been-focused":"input";a.find(l).each(function(){c(this).trigger("llms-validate-plan-field",{cascade:!1})}),a.find("."+s.validation_class).length?a.addClass(s.validation_class):a.removeClass(s.validation_class)}),s.$plans.on("llms-collapsible-toggled",".llms-access-plan",function(){var e=c(this);e.hasClass("opened")&&setTimeout(function(){e.find("input.llms-invalid").each(function(){c(this)[0].reportValidity()})},500)}),s.$plans.on("click",".llms-plan-delete",function(e){e.stopPropagation(),s.delete_plan(c(this))}),window.llms.metaboxes.post_select(c("#llms-access-plans .llms-availability-restrictions")),window.llms.metaboxes.post_select(c("#llms-access-plans .llms-checkout-redirect-page")),c("#_llms_plans_content_llms-new-access-plan-model").attr("disabled","disabled"),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,"_llms_plans_content_llms-new-access-plan-model")},this.bind_visibility=function(){var t=c("#llms-catalog-visibility-select"),a=c("a.llms-edit-catalog-visibility"),e=c("a.llms-save-catalog-visibility"),l=c("a.llms-cancel-catalog-visibility");a.on("click",function(e){e.preventDefault(),t.slideDown("fast"),a.hide()}),e.on("click",function(e){e.preventDefault(),t.slideUp("fast"),a.show(),c("#llms-catalog-visibility-display").text(c('input[name="_llms_visibility"]:checked').attr("data-label"))}),l.on("click",function(e){e.preventDefault(),t.slideUp("fast"),a.show()})},this.delete_plan=function(e){var t=this,a=e.closest(".llms-access-plan"),l=a.attr("data-id"),s=LLMS.l10n.translate("After deleting this access plan, any students subscribed to this plan will still have access and will continue to make recurring payments according to the access plan's settings. If you wish to terminate their plans you must do so manually. This action cannot be reversed.");l?window.confirm(s)&&(LLMS.Spinner.start(a),window.LLMS.Ajax.call({data:{action:"delete_access_plan",plan_id:l},success:function(e){setTimeout(function(){LLMS.Spinner.stop(a)},550),e.success?(t.remove_plan_el(a),t.trigger_update_hook(),setTimeout(function(){t.update_plan_orders()},500)):e.message&&alert(e.message)}})):t.remove_plan_el(a)},this.controller_change=function(e){var t=e.attr("data-controller-id"),i=e.val(),a=e.closest(".llms-access-plan").find('[data-controller="'+t+'"]');"checkbox"===e.attr("type")&&(i=e.is(":checked")?i:"no"),a.each(function(){var e,t,a=c(this),l="SELECT"===a[0].nodeName||"INPUT"===a[0].nodeName||"TEXTAREA"===a[0].nodeName?a:a.find("input, select, textarea"),s=a.attr("data-value-is"),n=a.attr("data-value-is-not");switch(void 0!==s&&!1!==s?t="==":void 0!==n&&!1!==n&&(t="!="),t){case"==":e=i==s?"show":"hide";break;case"!=":e=i!=n?"show":"hide"}"show"===e?(a.show(),l.removeAttr("disabled").trigger("change")):"hide"===e&&(a.hide(),l.attr("disabled","disabled"))})},this.get_current_plan_count=function(){return this.$plans.find(".llms-access-plan").length},this.get_plans_array=function(){tinyMCE.triggerSave();for(var e=this.$plans.closest("form").serializeArray(),t=[],a=0;a<e.length;a++)if(-1!==e[a].name.indexOf("_llms_plans")){var l=e[a].name.replace("_llms_plans[","").split("]["),s=1*l[0]-1,n=l[1].replace("]",""),i=3===l.length?"array":"single";t[s]||(t[s]={}),"array"==i?(t[s][n]||(t[s][n]=[]),t[s][n].push(e[a].value)):t[s][n]=e[a].value}return t},this.has_plan_limit_been_reached=function(){var e=window.llms.product.access_plan_limit;return this.get_current_plan_count()>=e},this.init_plan=function(){if(!this.has_plan_limit_been_reached()){var e=c("#llms-new-access-plan-model").clone();$existing_plans=c("#llms-access-plans .llms-access-plan"),$editor=e.find("#_llms_plans_content_llms-new-access-plan-model"),e.removeAttr("id"),$editor.removeAttr("id").attr("id","_llms_plans_content_"+this.temp_id),this.temp_id++,e.find("select, input, textarea").each(function(){c(this).removeAttr("disabled")}),e.find(".llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),e.appendTo("#llms-access-plans"),this.update_plan_orders(),e.find(".llms-collapsible-header").trigger("click"),this.has_plan_limit_been_reached()&&this.toggle_create_button("disable"),window.llms.metaboxes.post_select(e.find(".llms-availability-restrictions")),window.llms.metaboxes.post_select(e.find(".llms-checkout-redirect-page")),e.find("[data-controller-id]").trigger("change"),c(document).trigger("llms-plan-init",e)}},this.save_plans=function(){var t=this;if(t.$plans.find(".llms-access-plan").not("#llms-new-access-plan-model").each(function(){c(this).trigger("llms-validate-plan")}),t.$plans.find("."+t.validation_class).length)return t.$plans.find(".llms-access-plan."+t.validation_class).not(".opened").first().find(".llms-collapsible-header").trigger("click"),void c(document).trigger("llms-access-plan-validation-errors");LLMS.Spinner.start(t.$plans),t.$save.attr("disabled","disabled"),window.LLMS.Ajax.call({data:{action:"llms_update_access_plans",plans:t.get_plans_array()},complete:function(){LLMS.Spinner.stop(t.$plans),t.$save.removeAttr("disabled")},error:function(e,t,a){console.error("llms access plan save error encounterd:",e),alert(LLMS.l10n.translate("An error was encountered during the save attempt. Please try again.")+" ["+t+": "+a+"]")},success:function(e){!e.success&&e.code&&"error"===e.code?alert(e.message):e.data&&e.data.html&&(c("#llms-product-options-access-plans").replaceWith(e.data.html),t.init(!0),window.llms.metaboxes.init(),t.update_plan_orders(),t.trigger_update_hook())}})},this.toggle_button=function(e,t){"disable"===t?e.attr("disabled","disabled"):e.removeAttr("disabled")},this.toggle_create_button=function(e){this.toggle_button(c("#llms-new-access-plan"),e)},this.toggle_save_button=function(e){this.toggle_button(this.$save,e)},this.remove_plan_el=function(e){var t=this;e.fadeOut(400),setTimeout(function(){e.remove(),t.has_plan_limit_been_reached()||t.toggle_create_button("enable"),0===t.get_current_plan_count()&&t.toggle_save_button("disable")},450)},this.trigger_update_hook=function(){c(document).trigger("llms-access-plans-updated")},this.update_plan_orders=function(){c("#llms-access-plans .llms-access-plan").each(function(){var e=c(this),t=e.find(".plan-order"),a=e.find('textarea[id^="_llms_plans_content_"]').attr("id"),l=1*t.val(),s=e.index();tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,a),e.find("select, input, textarea").each(function(){var e=c(this).attr("name");e&&c(this).attr("name",e.replace(l,s))}),tinyMCE.EditorManager.execCommand("mceAddEditor",!0,a),t.val(s)})},this.init()};new window.llms.metabox_product}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtbWV0YWJveC1wcm9kdWN0LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJsbG1zIiwibWV0YWJveF9wcm9kdWN0IiwidGhpcyIsIiRwbGFucyIsIiRzYXZlIiwidGVtcF9pZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInZhbGlkYXRpb25fY2xhc3MiLCJpbml0Iiwic2tpcF9kZXBfY2hlY2tzIiwic2VsZiIsImJpbmRfdmlzaWJpbGl0eSIsIiRtYiIsImxlbmd0aCIsImJpbmQiLCJMTE1TIiwiU3Bpbm5lciIsInN0YXJ0IiwiaW50ZXJ2YWwiLCJjb3VudGVyIiwic2V0SW50ZXJ2YWwiLCJodG1sIiwibDEwbiIsInRyYW5zbGF0ZSIsInRpbnlNQ0UiLCJjbGVhckludGVydmFsIiwic3RvcCIsInNldFRpbWVvdXQiLCJoYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQiLCJ0b2dnbGVfY3JlYXRlX2J1dHRvbiIsImdldF9jdXJyZW50X3BsYW5fY291bnQiLCJ0b2dnbGVfc2F2ZV9idXR0b24iLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInNhdmVfcGxhbnMiLCJjb250cm9sbGVyX2NoYW5nZSIsIiRwbGFuX2NvbnRhaW5lciIsImNsb3Nlc3QiLCIkcGxhbl9yZWRpcmVjdF9mb3JjZWQiLCJmaW5kIiwiJHBsYW5fcmVkaXJlY3Rfc2V0dGluZ3MiLCJ2YWwiLCJwcm9wIiwic2hvdyIsImhpZGUiLCJ0b2dnbGUiLCJvZmYiLCJkYXRlcGlja2VyIiwiZGF0ZUZvcm1hdCIsInRyaWdnZXIiLCJpbml0X3BsYW4iLCJzb3J0YWJsZSIsImhhbmRsZSIsIml0ZW1zIiwiZXZlbnQiLCJ1aSIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJ1cGRhdGVfcGxhbl9vcmRlcnMiLCIkaW5wdXQiLCIkZGlzcGxheSIsInRpdGxlIiwiYXR0ciIsInRleHQiLCJkYXRhIiwiY2hlY2tWYWxpZGl0eSIsInR5cGUiLCJyZXBvcnRWYWxpZGl0eSIsImNhc2NhZGUiLCJvcmlnaW5hbF9ldmVudCIsIiRwbGFuIiwic2VsZWN0b3IiLCJlYWNoIiwiaGFzQ2xhc3MiLCJzdG9wUHJvcGFnYXRpb24iLCJkZWxldGVfcGxhbiIsIm1ldGFib3hlcyIsInBvc3Rfc2VsZWN0IiwiRWRpdG9yTWFuYWdlciIsImV4ZWNDb21tYW5kIiwiJHJhZGlvcyIsIiR0b2dnbGUiLCIkY2FuY2VsIiwic2xpZGVEb3duIiwic2xpZGVVcCIsIiRidG4iLCJwbGFuX2lkIiwid2FybmluZyIsImNvbmZpcm0iLCJBamF4IiwiY2FsbCIsImFjdGlvbiIsInN1Y2Nlc3MiLCJyIiwicmVtb3ZlX3BsYW5fZWwiLCJ0cmlnZ2VyX3VwZGF0ZV9ob29rIiwibWVzc2FnZSIsImFsZXJ0IiwiJGVsIiwiaWQiLCIkY29udHJvbHMiLCJpcyIsIm9wZXJhdG9yIiwiJGMiLCIkZWxzIiwibm9kZU5hbWUiLCJlcXVhbHMiLCJub3RfZXF1YWxzIiwicmVtb3ZlQXR0ciIsImdldF9wbGFuc19hcnJheSIsInRyaWdnZXJTYXZlIiwiZm9ybSIsInNlcmlhbGl6ZUFycmF5IiwicGxhbnMiLCJpIiwibmFtZSIsImluZGV4T2YiLCJrZXlzIiwicmVwbGFjZSIsInNwbGl0IiwiaW5kZXgiLCJwdXNoIiwidmFsdWUiLCJsaW1pdCIsInByb2R1Y3QiLCJhY2Nlc3NfcGxhbl9saW1pdCIsIiRjbG9uZSIsImNsb25lIiwiJGV4aXN0aW5nX3BsYW5zIiwiJGVkaXRvciIsImFwcGVuZFRvIiwiZG9jdW1lbnQiLCJub3QiLCJmaXJzdCIsImNvbXBsZXRlIiwiZXJyb3IiLCJqcVhIUiIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsImNvbnNvbGUiLCJyZXMiLCJjb2RlIiwicmVwbGFjZVdpdGgiLCJ0b2dnbGVfYnV0dG9uIiwic3RhdHVzIiwiZmFkZU91dCIsInJlbW92ZSIsIiRwIiwiJG9yZGVyIiwiZWRpdG9yX2lkIiwib3JpZyIsImN1cnIiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQU1BLFNBQVlBLEdBRVhDLE9BQU9DLEtBQU9ELE9B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bWV0YWJveC1wcm9kdWN0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvZHVjdCBPcHRpb25zIE1ldGFCb3hcbiAqIERpc3BsYXlzIG9uIENvdXJzZSAmIE1lbWJlcnNoaXAgUG9zdCBUeXBlc1xuICogQHNpbmNlICAgIDMuMC4wXG4gKiBAdmVyc2lvbiAgMy4zMC4wXG4gKi9cbiggZnVuY3Rpb24oICQgKSB7XG5cblx0d2luZG93LmxsbXMgPSB3aW5kb3cubGxtcyB8fCB7fTtcblxuXHR3aW5kb3cubGxtcy5tZXRhYm94X3Byb2R1Y3QgPSBmdW5jdGlvbigpIHtcblxuXHRcdC8qKlxuXHRcdCAqIGpRdWVyeSBvYmogZm9yIHRoZSBtYWluICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMnICkgZWxlbWVudC5cblx0XHQgKiBAdHlwZSBvYmpcblx0XHQgKi9cblx0XHR0aGlzLiRwbGFucyA9IG51bGw7XG5cblx0XHQvKipcblx0XHQgKiBqUXVlcnkgb2JqIGZvciB0aGUgbWFpbiAkKCAnI2xsbXMtc2F2ZS1hY2Nlc3MtcGxhbnMnICkgc2F2ZSBidXR0b24gZWxlbWVudC5cblx0XHQgKiBAdHlwZSBvYmpcblx0XHQgKi9cblx0XHR0aGlzLiRzYXZlID0gbnVsbDtcblxuXHRcdC8qKlxuXHRcdCAqIEEgcmFuZG9tbHkgZ2VuZXJhdGVkIHRlbXBvcmFyeSBJRCB1c2VkIGZvciB0aGUgdGlueU1DRSBlZGl0b3IncyBpZFxuXHRcdCAqIHdoZW4gYSBuZXcgcGxhbiBpcyBhZGRlZFxuXHRcdCAqIEB0eXBlIGludFxuXHRcdCAqL1xuXHRcdHRoaXMudGVtcF9pZCA9IE1hdGguZmxvb3IoICggTWF0aC5yYW5kb20oKSAqIDc3NzcgKSArIDc3NyApO1xuXG5cdFx0LyoqXG5cdFx0ICogQ1NTIGNsYXNzIG5hbWUgdXNlZCB0byBoaWdobGlnaHQgdmFsaWRhdGlvbiBlcnJvcnMgZm9yIHBsYW4gZmllbGRzXG5cdFx0ICogQHR5cGUgc3RyaW5nXG5cdFx0ICovXG5cdFx0dGhpcy52YWxpZGF0aW9uX2NsYXNzID0gJ2xsbXMtaW52YWxpZCc7XG5cblx0XHQvKipcblx0XHQgKiBJbml0aWFsaXplXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gICBib29sIHNraXBfZGVwX2NoZWNrcyBpZiB0cnVlLCBza2lwcyBkZXBlbmRlbmN5IGNoZWNrcy5cblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAzLjI5LjNcblx0XHQgKi9cblx0XHR0aGlzLmluaXQgPSBmdW5jdGlvbiggc2tpcF9kZXBfY2hlY2tzICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdHNlbGYuJHBsYW5zID0gJCggJyNsbG1zLWFjY2Vzcy1wbGFucycgKTtcblx0XHRcdHNlbGYuJHNhdmUgPSAkKCAnI2xsbXMtc2F2ZS1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdHNlbGYuYmluZF92aXNpYmlsaXR5KCk7XG5cblx0XHRcdHZhciAkbWIgPSAkKCAnI2xpZnRlcmxtcy1wcm9kdWN0ICNsbG1zLXByb2R1Y3Qtb3B0aW9ucy1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdGlmICggISAkbWIubGVuZ3RoICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2UgaWYgKCBza2lwX2RlcF9jaGVja3MgKSB7XG5cdFx0XHRcdHNlbGYuYmluZCgpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdExMTVMuU3Bpbm5lci5zdGFydCggJG1iICk7XG5cblx0XHRcdC8vIHdlIHJlbHkgb24gVGlueU1DRSBidXQgV29yZFByZXNzIGRvZXNuJ3QgcmVnaXN0ZXIgVGlueU1DRVxuXHRcdFx0Ly8gbGlrZSBldmVyeSBvdGhlciBhZG1pbiBzY3JpcHQgc28gd2UnbGwgZG8gYSBsaXR0bGUgZGVwZW5kZW5jeSBjaGVjayBoZXJlLi4uXG5cdFx0XHR2YXIgY291bnRlciA9IDAsXG5cdFx0XHRcdGludGVydmFsO1xuXG5cdFx0XHRpbnRlcnZhbCA9IHNldEludGVydmFsKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHQvLyBpZiB3ZSBnZXQgdG8gMzAgc2Vjb25kcyBkaXNwbGF5IGFuIGVycm9yIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKCBjb3VudGVyID49IDMwMCApIHtcblxuXHRcdFx0XHRcdCRtYi5odG1sKCBMTE1TLmwxMG4udHJhbnNsYXRlKCAnVGhlcmUgd2FzIGFuIGVycm9yIGxvYWRpbmcgdGhlIG5lY2Vzc2FyeSByZXNvdXJjZXMuIFBsZWFzZSB0cnkgYWdhaW4uJyApICk7XG5cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBpZiB3ZSBjYW4ndCBhY2Nlc3MgdGlueU1DRSwgaW5jcmVtZW50IGFuZCB3YWl0Li4uXG5cdFx0XHRcdGVsc2UgaWYgKCAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIHRpbnlNQ0UgKSB7XG5cblx0XHRcdFx0XHRjb3VudGVyKys7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gYmluZCB0aGUgZXZlbnRzLCB3ZSdyZSBnb29kIVxuXHRcdFx0XHRlbHNlIHtcblxuXHRcdFx0XHRcdHNlbGYuYmluZCgpO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjbGVhckludGVydmFsKCBpbnRlcnZhbCApO1xuXHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RvcCggJG1iICk7XG5cblx0XHRcdH0sIDEwMCApO1xuXG5cdFx0fTtcblxuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBET00gRXZlbnRzXG5cdFx0ICpcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHNpbmNlICAzLjMwLjAgQWRkIGNoZWNrb3V0IHJlZGlyZWN0IGZpZWxkcyBldmVudHMuXG5cdFx0ICogQHZlcnNpb24gMy4zMC4wXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKi9cblx0XHR0aGlzLmJpbmQgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBzZWxmLmhhc19wbGFuX2xpbWl0X2JlZW5fcmVhY2hlZCgpICkge1xuXHRcdFx0XHRcdHNlbGYudG9nZ2xlX2NyZWF0ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA1MDAgKTtcblxuXHRcdFx0aWYgKCAwID09PSBzZWxmLmdldF9jdXJyZW50X3BsYW5fY291bnQoKSApIHtcblx0XHRcdFx0c2VsZi50b2dnbGVfc2F2ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzYXZlIGFjY2VzcyBwbGFucyBidXR0b24uXG5cdFx0XHRzZWxmLiRzYXZlLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRzZWxmLnNhdmVfcGxhbnMoKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gYmluZCBjaGFuZ2UgZXZlbnRzIHRvIGZvcm0gZWxlbWVudCB0aGF0IGNvbnRyb2xzIGFub3RoZXIgZm9ybSBlbGVtZW50XG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2NoYW5nZScsICdbZGF0YS1jb250cm9sbGVyLWlkXScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzZWxmLmNvbnRyb2xsZXJfY2hhbmdlKCAkKCB0aGlzICkgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gQHRvZG8gUmVwbGFjZSB0aGlzIHdpdGggbXVsdGlwbGUgZGF0YS1jb250cm9sbGVyIGZ1bmN0aW9uYWxpdHkgaW4gbGxtcy1tZXRhYm94ZXMuanNcblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAnY2hhbmdlJywgJ3NlbGVjdFtuYW1lJD1cIlthdmFpbGFiaWxpdHldXCJdJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciAkcGxhbl9jb250YWluZXIgPSAkKCB0aGlzICkuY2xvc2VzdCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLFxuXHRcdFx0XHRcdCRwbGFuX3JlZGlyZWN0X2ZvcmNlZCA9ICRwbGFuX2NvbnRhaW5lci5maW5kKCAnaW5wdXRbbmFtZSQ9XCJbY2hlY2tvdXRfcmVkaXJlY3RfZm9yY2VkXVwiXScgKSxcblx0XHRcdFx0XHQkcGxhbl9yZWRpcmVjdF9zZXR0aW5ncyA9ICRwbGFuX2NvbnRhaW5lci5maW5kKCAnLmxsbXMtY2hlY2tvdXQtcmVkaXJlY3Qtc2V0dGluZ3MnICk7XG5cblx0XHRcdFx0aWYgKCAnbWVtYmVycycgPT09ICQoIHRoaXMgKS52YWwoKSApIHtcblx0XHRcdFx0XHRpZiAoICEgJHBsYW5fcmVkaXJlY3RfZm9yY2VkLnByb3AoICdjaGVja2VkJyApICkge1xuXHRcdFx0XHRcdFx0JHBsYW5fcmVkaXJlY3Rfc2V0dGluZ3MuaGlkZSgpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQkcGxhbl9yZWRpcmVjdF9zZXR0aW5ncy5zaG93KCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0JHBsYW5fcmVkaXJlY3RfZm9yY2VkLm9uKCAnY2hhbmdlJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQkcGxhbl9yZWRpcmVjdF9zZXR0aW5ncy50b2dnbGUoKTtcblx0XHRcdFx0XHR9ICk7XG5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkcGxhbl9yZWRpcmVjdF9mb3JjZWQub2ZmKCAnY2hhbmdlJyApO1xuXHRcdFx0XHRcdCRwbGFuX3JlZGlyZWN0X3NldHRpbmdzLnNob3coKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHRcdCQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYWNjZXNzLXBsYW4tZGF0ZXBpY2tlcicgKS5kYXRlcGlja2VyKCB7XG5cdFx0XHRcdGRhdGVGb3JtYXQ6IFwibW0vZGQveXlcIlxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyB0cmlnZ2VyIGNoYW5nZXMgb24gbG9hZCBmb3IgYWxsIGV4aXN0aW5nIHBsYW5zXG5cdFx0XHQkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIFtkYXRhLWNvbnRyb2xsZXItaWRdJyApLnRyaWdnZXIoICdjaGFuZ2UnICk7XG5cblx0XHRcdC8vIGFkZCBhIG5ldyBlbXB0eSBwbGFuIGludGVyZmFjZSBvbiBuZXcgcGxhbiBidXR0b24gY2xpY2suXG5cdFx0XHQkKCAnI2xsbXMtbmV3LWFjY2Vzcy1wbGFuJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0c2VsZi5pbml0X3BsYW4oKTtcblx0XHRcdFx0c2VsZi50b2dnbGVfY3JlYXRlX2J1dHRvbiggJ2Rpc2FibGUnICk7XG5cdFx0XHRcdHNlbGYudG9nZ2xlX3NhdmVfYnV0dG9uKCAnZW5hYmxlJyApO1xuXHRcdFx0XHRzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoICEgc2VsZi5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQoKSApIHtcblx0XHRcdFx0XHRcdHNlbGYudG9nZ2xlX2NyZWF0ZV9idXR0b24oICdlbmFibGUnICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCA1MDAgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0c2VsZi4kcGxhbnMuc29ydGFibGUoIHtcblx0XHRcdFx0aGFuZGxlOiAnLmxsbXMtZHJhZy1oYW5kbGUnLFxuXHRcdFx0XHRpdGVtczogJy5sbG1zLWFjY2Vzcy1wbGFuJyxcblx0XHRcdFx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7XG5cdFx0XHRcdFx0c2VsZi4kcGxhbnMuYWRkQ2xhc3MoICdkcmFnZ2luZycgKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0XHRzZWxmLiRwbGFucy5yZW1vdmVDbGFzcyggJ2RyYWdnaW5nJyApO1xuXHRcdFx0XHRcdHNlbGYudXBkYXRlX3BsYW5fb3JkZXJzKCk7XG5cdFx0XHRcdH0sXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIGJpbmQgdGV4dCBlbnRlcmVkIGludG8gdGhlIHRpdGxlIHRvIHRoZSBkaXNwbGF5ZWQgdGl0bGUgZm9yIGZhbmN5IGZ1blxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdrZXl1cCcsICdpbnB1dC5sbG1zLXBsYW4tdGl0bGUnLCBmdW5jdGlvbiggKSB7XG5cblx0XHRcdFx0dmFyICRpbnB1dCA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQkcGxhbiA9ICRpbnB1dC5jbG9zZXN0KCAnLmxsbXMtYWNjZXNzLXBsYW4nICksXG5cdFx0XHRcdFx0JGRpc3BsYXkgPSAkcGxhbi5maW5kKCAnc3Bhbi5sbG1zLXBsYW4tdGl0bGUnICksXG5cdFx0XHRcdFx0dmFsID0gJGlucHV0LnZhbCgpLFxuXHRcdFx0XHRcdHRpdGxlID0gKCB2YWwgKSA/IHZhbCA6ICRkaXNwbGF5LmF0dHIoICdkYXRhLWRlZmF1bHQnICk7XG5cblx0XHRcdFx0JGRpc3BsYXkudGV4dCggdGl0bGUgKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBSZWNvcmQgdGhhdCBhIGZpZWxkIGhhcyBiZWVuIGZvY3VzZWQgc28gd2UgY2FuIHR3ZWFrIHZhbGlkYXRpb24gdG8gb25seSB2YWxpZGF0ZSBcImVkaXRlZFwiIGZpZWxkcy5cblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAnZm9jdXNpbicsICdpbnB1dCcsIGZ1bmN0aW9uKCBlLCBkYXRhICkge1xuXHRcdFx0XHQkKCB0aGlzICkuYWRkQ2xhc3MoICdsbG1zLWhhcy1iZWVuLWZvY3VzZWQnICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGEgc2luZ2xlIGlucHV0IGZpZWxkXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2tleXVwIGZvY3Vzb3V0IGxsbXMtdmFsaWRhdGUtcGxhbi1maWVsZCcsICdpbnB1dCcsIGZ1bmN0aW9uKCBlLCBkYXRhICkge1xuXG5cdFx0XHRcdHZhciAkaW5wdXQgPSAkKCB0aGlzICk7XG5cblx0XHRcdFx0aWYgKCAkaW5wdXRbMF0uY2hlY2tWYWxpZGl0eSgpICkge1xuXHRcdFx0XHRcdCRpbnB1dC5yZW1vdmVDbGFzcyggc2VsZi52YWxpZGF0aW9uX2NsYXNzICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JGlucHV0LmFkZENsYXNzKCBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKTtcblx0XHRcdFx0XHRpZiAoICdrZXl1cCcgPT09IGUudHlwZSApIHtcblx0XHRcdFx0XHRcdCRpbnB1dFswXS5yZXBvcnRWYWxpZGl0eSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggISBkYXRhIHx8IGRhdGEuY2FzY2FkZSApIHtcblx0XHRcdFx0XHQkaW5wdXQuY2xvc2VzdCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLnRyaWdnZXIoICdsbG1zLXZhbGlkYXRlLXBsYW4nLCB7IG9yaWdpbmFsX2V2ZW50OiBlLnR5cGUgfSApO1xuXHRcdFx0XHR9XG5cblxuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2xsbXMtdmFsaWRhdGUtcGxhbicsICcubGxtcy1hY2Nlc3MtcGxhbicsIGZ1bmN0aW9uKCBlLCBkYXRhICkge1xuXG5cdFx0XHRcdGRhdGEgPSBkYXRhIHx8IHt9O1xuXG5cdFx0XHRcdHZhciAkcGxhbiA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQvLyBvbmx5IHZhbGlkYXRlIFwiZWRpdGVkXCIgZmllbGRzIGR1cmluZyBjYXNjYWRpbmcgdmFsaWRhdGlvbiBmcm9tIGlucHV0IHZhbGlkYXRpb25zLlxuXHRcdFx0XHRcdHNlbGVjdG9yID0gZGF0YS5vcmlnaW5hbF9ldmVudCA/ICdpbnB1dC5sbG1zLWhhcy1iZWVuLWZvY3VzZWQnIDogJ2lucHV0JztcblxuXHRcdFx0XHQkcGxhbi5maW5kKCBzZWxlY3RvciApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCQoIHRoaXMgKS50cmlnZ2VyKCAnbGxtcy12YWxpZGF0ZS1wbGFuLWZpZWxkJywgeyBjYXNjYWRlOiBmYWxzZSB9ICk7XG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0XHRpZiAoICRwbGFuLmZpbmQoICcuJyArIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApLmxlbmd0aCApIHtcblx0XHRcdFx0XHQkcGxhbi5hZGRDbGFzcyggc2VsZi52YWxpZGF0aW9uX2NsYXNzICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHBsYW4ucmVtb3ZlQ2xhc3MoIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0gKTtcblxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdsbG1zLWNvbGxhcHNpYmxlLXRvZ2dsZWQnLCAnLmxsbXMtYWNjZXNzLXBsYW4nLCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHR2YXIgJHBsYW4gPSAkKCB0aGlzICk7XG5cblx0XHRcdFx0aWYgKCAkcGxhbi5oYXNDbGFzcyggJ29wZW5lZCcgKSApIHtcblx0XHRcdFx0XHQvLyB3YWl0IGZvciBhbmltYXRpb24gdG8gY29tcGxldGUgdG8gcHJldmVudCBmb2N1c2FibGUgZXJyb3JzIGluIHRoZSBjb25zb2xlLlxuXHRcdFx0XHRcdHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0JHBsYW4uZmluZCggJ2lucHV0LmxsbXMtaW52YWxpZCcgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0JCggdGhpcyApWzBdLnJlcG9ydFZhbGlkaXR5KCk7XG5cdFx0XHRcdFx0XHR9ICk7XG5cdFx0XHRcdFx0fSwgNTAwICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2NsaWNrJywgJy5sbG1zLXBsYW4tZGVsZXRlJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdHNlbGYuZGVsZXRlX3BsYW4oICQoIHRoaXMgKSApO1xuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBzZWxlY3QyaWZ5IG1lbWJlcnNoaXAgYXZhaWxhYmlsaXR5IGZpZWxkc1xuXHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLnBvc3Rfc2VsZWN0KCAkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWF2YWlsYWJpbGl0eS1yZXN0cmljdGlvbnMnICkgKTtcblxuXHRcdFx0Ly8gc2VsZWN0MmlmeSByZWRpcmVjdGlvbiBwYWdlIGZpZWxkc1xuXHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLnBvc3Rfc2VsZWN0KCAkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWNoZWNrb3V0LXJlZGlyZWN0LXBhZ2UnICkgKTtcblxuXHRcdFx0Ly8gZGlzYWJsZSB0aGUgdGV4dGFyZWEgZ2VuZXJhdGVkIGJ5IHRoZSB3cF9lZGl0b3IgZnVuY3Rpb25cblx0XHRcdC8vIGNhbid0IGZpZ3VyZSBvdXQgaG93IHRvIGRvIHRoaXMgZHVyaW5nIGluaXRpYWxpemF0aW9uXG5cdFx0XHQkKCAnI19sbG1zX3BsYW5zX2NvbnRlbnRfbGxtcy1uZXctYWNjZXNzLXBsYW4tbW9kZWwnICkuYXR0ciggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuXHRcdFx0dGlueU1DRS5FZGl0b3JNYW5hZ2VyLmV4ZWNDb21tYW5kKCAnbWNlUmVtb3ZlRWRpdG9yJywgdHJ1ZSwgJ19sbG1zX3BsYW5zX2NvbnRlbnRfbGxtcy1uZXctYWNjZXNzLXBsYW4tbW9kZWwnICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBET00gZXZlbnRzIGZvciBlZGl0aW5nIHByb2R1Y3QgdmlzaWJpbGl0eVxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuNi4wXG5cdFx0ICogQHZlcnNpb24gIDMuNi4wXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kX3Zpc2liaWxpdHkgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyICRyYWRpb3MgPSAkKCAnI2xsbXMtY2F0YWxvZy12aXNpYmlsaXR5LXNlbGVjdCcgKSxcblx0XHRcdFx0JHRvZ2dsZSA9ICQoICdhLmxsbXMtZWRpdC1jYXRhbG9nLXZpc2liaWxpdHknICksXG5cdFx0XHRcdCRzYXZlID0gJCggJ2EubGxtcy1zYXZlLWNhdGFsb2ctdmlzaWJpbGl0eScgKSxcblx0XHRcdFx0JGNhbmNlbCA9ICAkKCAnYS5sbG1zLWNhbmNlbC1jYXRhbG9nLXZpc2liaWxpdHknICk7XG5cblx0XHRcdCR0b2dnbGUub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCRyYWRpb3Muc2xpZGVEb3duKCAnZmFzdCcgKTtcblx0XHRcdFx0JHRvZ2dsZS5oaWRlKCk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdCRzYXZlLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHQkcmFkaW9zLnNsaWRlVXAoICdmYXN0JyApO1xuXHRcdFx0XHQkdG9nZ2xlLnNob3coKTtcblx0XHRcdFx0JCggJyNsbG1zLWNhdGFsb2ctdmlzaWJpbGl0eS1kaXNwbGF5JyApLnRleHQoICQoICdpbnB1dFtuYW1lPVwiX2xsbXNfdmlzaWJpbGl0eVwiXTpjaGVja2VkJyApLmF0dHIoICdkYXRhLWxhYmVsJyApICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdCRjYW5jZWwub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCRyYWRpb3Muc2xpZGVVcCggJ2Zhc3QnICk7XG5cdFx0XHRcdCR0b2dnbGUuc2hvdygpO1xuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEhhbmRsZSBwaHlzaWNhbCBkZWxldGlvbiBvZiBhIHBsYW4gZWxlbWVudFxuXHRcdCAqIElmIHRoZSBwbGFuIGhhc24ndCBiZSBwZXJzaXN0ZWQgdG8gdGhlIGRhdGFic2UgaXQncyByZW1vdmVkIGZyb20gdGhlIGRvbVxuXHRcdCAqIGlmIGl0IGFscmVhZHkgZXhpc3RzIGluIHRoZSBkYXRhYmFzZSBhIGNvbmZpcm0gbW9kYWwgaXMgZGlzcGxheWVkXG5cdFx0ICogdXBvbiBjb25maXJtYXRpb24gQUpBWCBjYWxsIHdpbGwgYmUgbWFkZSB0byBtb3ZlIHRoZSBwbGFuIHRvIHRoZSB0cmFzaFxuXHRcdCAqIGFuZCB1cG9uIHN1Y2Nlc3MgdGhlIGVsZW1lbnQgd2lsbCBiZSByZW1vdmVkIGZyb20gdGhlIGRvbVxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBvYmogJGJ0biBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIFwiWFwiIGJ1dHRvbiBjbGlja2VkIHRvIGluaXRpYXRlIGRlbGV0aW9uXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMjkuMVxuXHRcdCAqL1xuXHRcdHRoaXMuZGVsZXRlX3BsYW4gPSBmdW5jdGlvbiggJGJ0biApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHQkcGxhbiA9ICRidG4uY2xvc2VzdCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLFxuXHRcdFx0XHRwbGFuX2lkID0gJHBsYW4uYXR0ciggJ2RhdGEtaWQnICksXG5cdFx0XHRcdHdhcm5pbmcgPSBMTE1TLmwxMG4udHJhbnNsYXRlKCAnQWZ0ZXIgZGVsZXRpbmcgdGhpcyBhY2Nlc3MgcGxhbiwgYW55IHN0dWRlbnRzIHN1YnNjcmliZWQgdG8gdGhpcyBwbGFuIHdpbGwgc3RpbGwgaGF2ZSBhY2Nlc3MgYW5kIHdpbGwgY29udGludWUgdG8gbWFrZSByZWN1cnJpbmcgcGF5bWVudHMgYWNjb3JkaW5nIHRvIHRoZSBhY2Nlc3MgcGxhblxcJ3Mgc2V0dGluZ3MuIElmIHlvdSB3aXNoIHRvIHRlcm1pbmF0ZSB0aGVpciBwbGFucyB5b3UgbXVzdCBkbyBzbyBtYW51YWxseS4gVGhpcyBhY3Rpb24gY2Fubm90IGJlIHJldmVyc2VkLicgKTtcblxuXHRcdFx0Ly8gaWYgdGhlcmUncyBubyBJRCBqdXN0IHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBET01cblx0XHRcdGlmICggISBwbGFuX2lkICkge1xuXG5cdFx0XHRcdHNlbGYucmVtb3ZlX3BsYW5fZWwoICRwbGFuICk7XG5cblx0XHRcdC8vIFRocm93IGEgY29uZmlybWF0aW9uIHdhcm5pbmdcblx0XHRcdH0gZWxzZSBpZiAoIHdpbmRvdy5jb25maXJtKCB3YXJuaW5nICkgKSB7XG5cblx0XHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkcGxhbiApO1xuXHRcdFx0XHR3aW5kb3cuTExNUy5BamF4LmNhbGwoIHtcblx0XHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0XHRhY3Rpb246ICdkZWxldGVfYWNjZXNzX3BsYW4nLFxuXHRcdFx0XHRcdFx0cGxhbl9pZDogcGxhbl9pZCxcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCByICkge1xuXHRcdFx0XHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdExMTVMuU3Bpbm5lci5zdG9wKCAkcGxhbiApO1xuXHRcdFx0XHRcdFx0fSwgNTUwICk7XG5cdFx0XHRcdFx0XHRpZiAoIHIuc3VjY2VzcyApIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVfcGxhbl9lbCggJHBsYW4gKTtcblx0XHRcdFx0XHRcdFx0c2VsZi50cmlnZ2VyX3VwZGF0ZV9ob29rKCk7XG5cdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHNlbGYudXBkYXRlX3BsYW5fb3JkZXJzKCk7XG5cdFx0XHRcdFx0XHRcdH0sIDUwMCApO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmICggci5tZXNzYWdlICkge1xuXHRcdFx0XHRcdFx0XHRhbGVydCggci5tZXNzYWdlICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEhhbmRsZSBoaWRpbmcgJiBzaG93aW5nIHZhcmlvcyBwaWVjZXMgb2YgYW4gYWNjZXNzIHBsYW4gZm9ybVxuXHRcdCAqIFRoaXMgaXMgYm91bmQgdG8gYW55IGZvcm0gZWxlbWVudCB3aXRoIGEgXCJkYXRhLWNvbnRyb2xsZXItaWRcIiBwcm9wZXJ0eVxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBvYmogICRlbCAgIGpRdWVyeSBzZWxlY3RvciBmb3IgdGhlIGNoYW5nZWQgZm9ybSBlbGVtZW50XG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuY29udHJvbGxlcl9jaGFuZ2UgPSBmdW5jdGlvbiggJGVsICkge1xuXG5cdFx0XHR2YXIgaWQgPSAkZWwuYXR0ciggJ2RhdGEtY29udHJvbGxlci1pZCcgKSxcblx0XHRcdFx0dmFsID0gJGVsLnZhbCgpLFxuXHRcdFx0XHQkZm9ybSA9ICRlbC5jbG9zZXN0KCAnLmxsbXMtYWNjZXNzLXBsYW4nICksXG5cdFx0XHRcdCRjb250cm9scyA9ICRmb3JtLmZpbmQoICdbZGF0YS1jb250cm9sbGVyPVwiJyArIGlkICsgJ1wiXScpO1xuXG5cdFx0XHRpZiAoICdjaGVja2JveCcgPT09ICRlbC5hdHRyKCAndHlwZScgKSApICB7XG5cdFx0XHRcdHZhbCA9ICggJGVsLmlzKCAnOmNoZWNrZWQnICkgKSA/IHZhbCA6ICdubyc7XG5cdFx0XHR9XG5cblx0XHRcdCRjb250cm9scy5lYWNoKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHR2YXIgJGMgPSAkKCB0aGlzICksXG5cdFx0XHRcdFx0JGVscyA9ICggJ1NFTEVDVCcgPT09ICRjWzBdLm5vZGVOYW1lIHx8ICdJTlBVVCcgID09PSAkY1swXS5ub2RlTmFtZSB8fCAnVEVYVEFSRUEnICA9PT0gJGNbMF0ubm9kZU5hbWUgKSA/ICRjIDogJGMuZmluZCggJ2lucHV0LCBzZWxlY3QsIHRleHRhcmVhJyApLFxuXHRcdFx0XHRcdGVxdWFscyA9ICRjLmF0dHIoICdkYXRhLXZhbHVlLWlzJyApLFxuXHRcdFx0XHRcdG5vdF9lcXVhbHMgPSAkYy5hdHRyKCAnZGF0YS12YWx1ZS1pcy1ub3QnICksXG5cdFx0XHRcdFx0YWN0aW9uLCBvcGVyYXRvcjtcblxuXHRcdFx0XHRpZiAoIHR5cGVvZiBlcXVhbHMgIT09IHR5cGVvZiB1bmRlZmluZWQgJiYgZXF1YWxzICE9PSBmYWxzZSApIHtcblxuXHRcdFx0XHRcdG9wZXJhdG9yID0gJz09JztcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCB0eXBlb2Ygbm90X2VxdWFscyAhPT0gdHlwZW9mIHVuZGVmaW5lZCAmJiBub3RfZXF1YWxzICE9PSBmYWxzZSApIHtcblxuXHRcdFx0XHRcdG9wZXJhdG9yID0gJyE9JztcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3dpdGNoICggb3BlcmF0b3IgKSB7XG5cblx0XHRcdFx0XHRjYXNlICc9PSc6XG5cblx0XHRcdFx0XHRcdGlmICggdmFsID09IGVxdWFscyApIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ3Nob3cnO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ2hpZGUnO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRjYXNlICchPSc6XG5cblx0XHRcdFx0XHRcdGlmICggdmFsICE9IG5vdF9lcXVhbHMgKSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbiA9ICdzaG93Jztcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbiA9ICdoaWRlJztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoICdzaG93JyA9PT0gYWN0aW9uICkge1xuXHRcdFx0XHRcdCRjLnNob3coKTtcblx0XHRcdFx0XHQkZWxzLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKS50cmlnZ2VyKCAnY2hhbmdlJyApO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAnaGlkZScgPT09IGFjdGlvbiApIHtcblx0XHRcdFx0XHQkYy5oaWRlKCk7XG5cdFx0XHRcdFx0JGVscy5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFJldHJpZXZlIHRoZSBjdXJyZW50IG51bWJlciBvZiBhY2Nlc3MgcGxhbnMgZm9yIHRoZSBjb3Vyc2UgLyBtZW1iZXJzaGlwIChzYXZlZCBvciB1bnNhdmVkKVxuXHRcdCAqIEByZXR1cm4gIGludFxuXHRcdCAqIEBzaW5jZSAgIDMuMjkuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMjkuMFxuXHRcdCAqL1xuXHRcdHRoaXMuZ2V0X2N1cnJlbnRfcGxhbl9jb3VudCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuJHBsYW5zLmZpbmQoICcubGxtcy1hY2Nlc3MtcGxhbicgKS5sZW5ndGg7XG5cdFx0fVxuXG5cdFx0LyoqXG5cdFx0ICogUmV0cmlldmUgYWNjZXNzIHBsYW4gZGF0YSBhcyBhbiBhcnJheSBvZiBKU09OIGJ1aWx0IGZyb20gdGhlIGRvbSBlbGVtZW50IGZpZWxkIHZhbHVlcy5cblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gIGFycmF5XG5cdFx0ICogQHNpbmNlICAgMy4yOS4wXG5cdFx0ICogQHZlcnNpb24gMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy5nZXRfcGxhbnNfYXJyYXkgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0Ly8gZW5zdXJlIGFsbCBjb250ZW50IGVkaXRvcnMgYXJlIHNhdmVkIHByb3Blcmx5LlxuXHRcdFx0dGlueU1DRS50cmlnZ2VyU2F2ZSgpO1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdGZvcm0gPSBzZWxmLiRwbGFucy5jbG9zZXN0KCAnZm9ybScgKS5zZXJpYWxpemVBcnJheSgpLFxuXHRcdFx0XHRwbGFucyA9IFtdO1xuXG5cdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBmb3JtLmxlbmd0aDsgaSsrICkge1xuXG5cdFx0XHRcdC8vIFNraXAgbm9uIHBsYW4gZGF0YSBmcm9tIHRoZSBmb3JtLlxuXHRcdFx0XHRpZiAoIC0xID09PSBmb3JtWyBpIF0ubmFtZS5pbmRleE9mKCAnX2xsbXNfcGxhbnMnICkgKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIga2V5cyA9IGZvcm1bIGkgXS5uYW1lLnJlcGxhY2UoICdfbGxtc19wbGFuc1snLCAnJyApLnNwbGl0KCAnXVsnICksXG5cdFx0XHRcdFx0aW5kZXggPSAoIGtleXNbMF0gKiAxICkgLSAxLFxuXHRcdFx0XHRcdG5hbWUgPSBrZXlzWzFdLnJlcGxhY2UoICddJywgJycgKSxcblx0XHRcdFx0XHR0eXBlID0gMyA9PT0ga2V5cy5sZW5ndGggPyAnYXJyYXknIDogJ3NpbmdsZSc7XG5cblx0XHRcdFx0aWYgKCAhIHBsYW5zWyBpbmRleCBdICkge1xuXHRcdFx0XHRcdHBsYW5zWyBpbmRleCBdID0ge307XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoICdhcnJheScgPT09IHR5cGUgKSB7XG5cblx0XHRcdFx0XHRpZiAoICEgcGxhbnNbIGluZGV4IF1bIG5hbWUgXSApIHtcblx0XHRcdFx0XHRcdHBsYW5zWyBpbmRleCBdWyBuYW1lIF0gPSBbXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cGxhbnNbIGluZGV4IF1bIG5hbWUgXS5wdXNoKCBmb3JtWyBpIF0udmFsdWUgKTtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0cGxhbnNbIGluZGV4IF1bIG5hbWUgXSA9IGZvcm1bIGkgXS52YWx1ZTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHBsYW5zO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIERldGVybWluZSBpZiB0aGUgYWNjZXNzIHBsYW4gbGltaXQgaGFzIGJlZW4gcmVhY2hlZFxuXHRcdCAqXG5cdFx0ICogQHJldHVybiBCb29sZWFuXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjI5LjBcblx0XHQgKi9cblx0XHR0aGlzLmhhc19wbGFuX2xpbWl0X2JlZW5fcmVhY2hlZCA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgbGltaXQgPSB3aW5kb3cubGxtcy5wcm9kdWN0LmFjY2Vzc19wbGFuX2xpbWl0O1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0X2N1cnJlbnRfcGxhbl9jb3VudCgpID49IGxpbWl0O1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEluaXRhbGl6ZXMgYSBuZXcgcGxhbiBhbmQgYWRkcyBpdCB0byB0aGUgbGlzdCBvZiBwbGFucyBpbiB0aGUgRE9NXG5cdFx0ICpcblx0XHQgKiBAc2luY2UgMy4wLjBcblx0XHQgKiBAc2luY2UgMy4zMC4wIEluaXRpYWxpemUgc2VsZWN0MiBvbiBjaGVja291dCByZWRpcmVjdCBmaWVsZHMuXG5cdFx0ICogQHZlcnNpb24gMy4zMC4wXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqL1xuXHRcdHRoaXMuaW5pdF9wbGFuID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdC8vIGRvbid0IGRvIGFueXRoaW5nIGlmIHdlJ3ZlIHJlYWNoZWQgdGhlIHBsYW4gbGltaXRcblx0XHRcdGlmICggdGhpcy5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQoKSApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgJGNsb25lID0gJCggJyNsbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKS5jbG9uZSgpXG5cdFx0XHRcdCRleGlzdGluZ19wbGFucyA9ICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYWNjZXNzLXBsYW4nICksXG5cdFx0XHRcdCRlZGl0b3IgPSAkY2xvbmUuZmluZCggJyNfbGxtc19wbGFuc19jb250ZW50X2xsbXMtbmV3LWFjY2Vzcy1wbGFuLW1vZGVsJyApO1xuXG5cdFx0XHQvLyByZW1vdmUgSUQgZnJvbSB0aGUgaXRlbVxuXHRcdFx0JGNsb25lLnJlbW92ZUF0dHIoICdpZCcgKTtcblxuXHRcdFx0Ly8gZ2l2ZSBhIHRlbXBvcmFyeSBpZCB0byB0aGUgZWRpdG9yIGVsZW1lbnRcblx0XHRcdCRlZGl0b3IucmVtb3ZlQXR0ciggJ2lkJyApLmF0dHIoICdpZCcsICdfbGxtc19wbGFuc19jb250ZW50XycgKyB0aGlzLnRlbXBfaWQgKTtcblx0XHRcdHRoaXMudGVtcF9pZCsrOyAvLyBpbmNyZW1lbnQgdGhlIHRlbXBfaWQgSUQgc28gd2UgZG9uJ3QgdXNlIGl0IGFnYWluXG5cblxuXHRcdFx0Ly8gYWN0aXZhdGUgYWxsIGVsZW1lbnRzXG5cdFx0XHQkY2xvbmUuZmluZCggJ3NlbGVjdCwgaW5wdXQsIHRleHRhcmVhJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCB0aGlzICkucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApOyAvLyBlbmFibGVkIHRoZSBmaWVsZFxuXHRcdFx0fSApO1xuXG5cblx0XHRcdCRjbG9uZS5maW5kKCAnLmxsbXMtYWNjZXNzLXBsYW4tZGF0ZXBpY2tlcicgKS5kYXRlcGlja2VyKCB7XG5cdFx0XHRcdGRhdGVGb3JtYXQ6IFwibW0vZGQveXlcIlxuXHRcdFx0fSApO1xuXG5cdFx0XHQkY2xvbmUuYXBwZW5kVG8oICcjbGxtcy1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdC8vIHJld3JpdGUgdGhlIG9yZGVyIG9mIGFsbCBlbGVtZW50c1xuXHRcdFx0dGhpcy51cGRhdGVfcGxhbl9vcmRlcnMoKTtcblxuXHRcdFx0JGNsb25lLmZpbmQoICcubGxtcy1jb2xsYXBzaWJsZS1oZWFkZXInICkudHJpZ2dlciggJ2NsaWNrJyApO1xuXG5cdFx0XHQvLyBjaGVjayBpZiB0aGUgbGltaXQgaGFzIGJlZW4gcmVhY2hlZCBhbmQgdG9nZ2xlIHRoZSBidXR0b24gaWYgaXQgaGFzXG5cdFx0XHRpZiAoIHRoaXMuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdHRoaXMudG9nZ2xlX2NyZWF0ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzZWxlY3QyaWZ5IG1lbWJlcnNoaXAgYXZhaWxhYmlsaXR5IGZpZWxkXG5cdFx0XHR3aW5kb3cubGxtcy5tZXRhYm94ZXMucG9zdF9zZWxlY3QoICRjbG9uZS5maW5kKCAnLmxsbXMtYXZhaWxhYmlsaXR5LXJlc3RyaWN0aW9ucycgKSApO1xuXG5cdFx0XHQvLyBzZWxlY3QyaWZ5IHJlZGlyZWN0aW9uIHBhZ2UgZmllbGRzXG5cdFx0XHR3aW5kb3cubGxtcy5tZXRhYm94ZXMucG9zdF9zZWxlY3QoICRjbG9uZS5maW5kKCAnLmxsbXMtY2hlY2tvdXQtcmVkaXJlY3QtcGFnZScgKSApO1xuXG5cdFx0XHQkY2xvbmUuZmluZCggJ1tkYXRhLWNvbnRyb2xsZXItaWRdJyApLnRyaWdnZXIoICdjaGFuZ2UnICk7XG5cdFx0XHQkKCBkb2N1bWVudCApLnRyaWdnZXIoICdsbG1zLXBsYW4taW5pdCcsICRjbG9uZSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFBlcnNpc3QgYWNjZXNzIHBsYW5zIHRvIHRoZSBEQiBpZiB0aGV5IHBhc3MgdmFsaWRhdGlvblxuXHRcdCAqXG5cdFx0ICogQHJldHVybiAge1t0eXBlXX1cblx0XHQgKiBAc2luY2UgICAzLjI5LjBcblx0XHQgKiBAdmVyc2lvbiAzLjI5LjBcblx0XHQgKi9cblx0XHR0aGlzLnNhdmVfcGxhbnMgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5maW5kKCAnLmxsbXMtYWNjZXNzLXBsYW4nICkubm90KCAnI2xsbXMtbmV3LWFjY2Vzcy1wbGFuLW1vZGVsJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCB0aGlzICkudHJpZ2dlciggJ2xsbXMtdmFsaWRhdGUtcGxhbicgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0aWYgKCBzZWxmLiRwbGFucy5maW5kKCAnLicgKyBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKS5sZW5ndGggKSB7XG5cdFx0XHRcdHNlbGYuJHBsYW5zLmZpbmQoICcubGxtcy1hY2Nlc3MtcGxhbi4nICsgc2VsZi52YWxpZGF0aW9uX2NsYXNzICkubm90KCAnLm9wZW5lZCcgKS5maXJzdCgpLmZpbmQoICcubGxtcy1jb2xsYXBzaWJsZS1oZWFkZXInICkudHJpZ2dlciggJ2NsaWNrJyApO1xuXHRcdFx0XHQkKCBkb2N1bWVudCApLnRyaWdnZXIoICdsbG1zLWFjY2Vzcy1wbGFuLXZhbGlkYXRpb24tZXJyb3JzJyApO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdExMTVMuU3Bpbm5lci5zdGFydCggc2VsZi4kcGxhbnMgKTtcblx0XHRcdHNlbGYuJHNhdmUuYXR0ciggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuXHRcdFx0d2luZG93LkxMTVMuQWpheC5jYWxsKCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICdsbG1zX3VwZGF0ZV9hY2Nlc3NfcGxhbnMnLFxuXHRcdFx0XHRcdHBsYW5zOiBzZWxmLmdldF9wbGFuc19hcnJheSgpLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRjb21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0TExNUy5TcGlubmVyLnN0b3AoIHNlbGYuJHBsYW5zICk7XG5cdFx0XHRcdFx0c2VsZi4kc2F2ZS5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbigganFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duICkge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoICdsbG1zIGFjY2VzcyBwbGFuIHNhdmUgZXJyb3IgZW5jb3VudGVyZDonLCBqcVhIUiApO1xuXHRcdFx0XHRcdGFsZXJ0KCBMTE1TLmwxMG4udHJhbnNsYXRlKCAnQW4gZXJyb3Igd2FzIGVuY291bnRlcmQgZHVyaW5nIHRoZSBzYXZlIGF0dGVtcHQuIFBsZWFzZSB0cnkgYWdhaW4uJyApICsgJyBbJyAgKyB0ZXh0U3RhdHVzICsgJzogJyArIGVycm9yVGhyb3duICsgJ10nICk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCByZXMgKSB7XG5cblx0XHRcdFx0XHRpZiAoICEgcmVzLnN1Y2Nlc3MgJiYgcmVzLmNvZGUgJiYgJ2Vycm9yJyA9PT0gcmVzLmNvZGUgKSB7XG5cdFx0XHRcdFx0XHRhbGVydCggcmVzLm1lc3NhZ2UgKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCByZXMuZGF0YSAmJiByZXMuZGF0YS5odG1sICkge1xuXG5cdFx0XHRcdFx0XHQvLyByZXBsYWNlIHRoZSBtZXRhYm94IHdpdGggdXBkYXRlZCBkYXRhIGZyb20gdGhlIHNlcnZlci5cblx0XHRcdFx0XHRcdCQoICcjbGxtcy1wcm9kdWN0LW9wdGlvbnMtYWNjZXNzLXBsYW5zJyApLnJlcGxhY2VXaXRoKCByZXMuZGF0YS5odG1sICk7XG5cblx0XHRcdFx0XHRcdC8vIHJlaW5pdC5cblx0XHRcdFx0XHRcdHNlbGYuaW5pdCggdHJ1ZSApO1xuXHRcdFx0XHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLmluaXQoKTtcblx0XHRcdFx0XHRcdHNlbGYudXBkYXRlX3BsYW5fb3JkZXJzKCk7XG5cblx0XHRcdFx0XHRcdC8vIG5vdGlmeSB0aGUgYmxvY2sgZWRpdG9yXG5cdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXJfdXBkYXRlX2hvb2soKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9LFxuXG5cdFx0XHR9ICk7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFRvZ2dsZSB0aGUgc3RhdHVzIG9mIGEgYnV0dG9uXG5cdFx0ICogQHBhcmFtICAgT2JqZWN0ICAkYnRuICAgalF1ZXJ5IHNlbGVjdG9yIG9mIGEgYnV0dG9uIGVsZW1lbnRcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBzdGF0dXMgZW5hYmxlIG9yIGRpc2FibGVcblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgMy4yOS4wXG5cdFx0ICogQHZlcnNpb24gMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy50b2dnbGVfYnV0dG9uID0gZnVuY3Rpb24oICRidG4sIHN0YXR1cyApIHtcblxuXHRcdFx0aWYgKCAnZGlzYWJsZScgPT09IHN0YXR1cyApIHtcblx0XHRcdFx0JGJ0bi5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkYnRuLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblx0XHRcdH1cblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBDb250cm9sIHRoZSBzdGF0dXMgb2YgdGhlIFwiTmV3IEFjY2VzcyBQbGFuXCIgQnV0dG9uXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBzdGF0dXMgZW5hYmxlIG9yIGRpc2FibGVcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHNpbmNlICAzLjI5LjBcblx0XHQgKi9cblx0XHR0aGlzLnRvZ2dsZV9jcmVhdGVfYnV0dG9uID0gZnVuY3Rpb24oIHN0YXR1cyApIHtcblx0XHRcdHRoaXMudG9nZ2xlX2J1dHRvbiggJCggJyNsbG1zLW5ldy1hY2Nlc3MtcGxhbicgKSwgc3RhdHVzICk7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIENvbnRyb2wgdGhlIHN0YXR1cyBvZiB0aGUgXCJTYXZlIEFjY2VzcyBQbGFuc1wiIEJ1dHRvblxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBzdHJpbmcgc3RhdHVzIGVuYWJsZSBvciBkaXNhYmxlXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqIEBzaW5jZSAgMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy50b2dnbGVfc2F2ZV9idXR0b24gPSBmdW5jdGlvbiggc3RhdHVzICkge1xuXHRcdFx0dGhpcy50b2dnbGVfYnV0dG9uKCB0aGlzLiRzYXZlLCBzdGF0dXMgKTtcblx0XHR9XG5cblx0XHQvKipcblx0XHQgKiBWaXN1YWxseSBoaWRlIGFuZCB0aGVuIHBoeXNpY2FsbHkgcmVtb3ZlIGEgcGxhbiBlbGVtZW50IGZyb20gdGhlIERPTVxuXHRcdCAqIEFkZGl0aW9uYWxseSBkZXRlcm1pbmVzIGlmIHRoZSBOZXcgUGxhbiBCdXR0b24gc2hvdWxkIGJlIHJlLWVuYWJsZWRcblx0XHQgKiBhZnRlciBkZWxldGlvblxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBvYmogICAkcGxhbiBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIHBsYW4gZWxlbWVudFxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqIEBzaW5jZSAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMjkuMFxuXHRcdCAqL1xuXHRcdHRoaXMucmVtb3ZlX3BsYW5fZWwgPSBmdW5jdGlvbiggJHBsYW4gKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0Ly8gZmFkZSBvdXQgbmljZWx5XG5cdFx0XHQkcGxhbi5mYWRlT3V0KCA0MDAgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGZyb20gZG9tIGFmdGVyIGl0J3MgaGlkZGVuIHZpc3VhbGx5XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdCRwbGFuLnJlbW92ZSgpO1xuXG5cdFx0XHRcdC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gcmVlbmFibGUgdGhlIGNyZWF0ZSBidXR0b24gYW5kIGhpZGUgdGhlIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKCAhIHNlbGYuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdFx0c2VsZi50b2dnbGVfY3JlYXRlX2J1dHRvbiggJ2VuYWJsZScgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggMCA9PT0gc2VsZi5nZXRfY3VycmVudF9wbGFuX2NvdW50KCkgKSB7XG5cdFx0XHRcdFx0c2VsZi50b2dnbGVfc2F2ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0sIDQ1MCApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFRyaWdnZXIgV1AgQmxvY2sgRWRpdG9yIGhvb2sgc28gdGhlIHByaWNpbmcgdGFibGUgYmxvY2sgY2FuIGJlIHJlLXJlbmRlcmVkIHdpdGggbmV3IHBsYW4gaW5mb3JtYXRpb24uXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgMy4yOS4wXG5cdFx0ICogQHZlcnNpb24gMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy50cmlnZ2VyX3VwZGF0ZV9ob29rID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdCQoIGRvY3VtZW50ICkudHJpZ2dlciggJ2xsbXMtYWNjZXNzLXBsYW5zLXVwZGF0ZWQnICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogUmVvcmRlciB0aGUgYXJyYXkgaW5kZXhlcyBhbmQgdGhlIG1lbnUgb3JkZXIgaGlkZGVuIGlucHV0c1xuXHRcdCAqIENhbGxlZCBieSBqUXVlcnkgVUkgU29ydGFibGUgb24gc29ydCBjb21wbGV0aW9uXG5cdFx0ICogQWxzbyBjYWxsZWQgYWZ0ZXIgYWRkaW5nIGEgbmV3IHBsYW4gdG8gdGhlIERPTSBzbyB0aGUgbmV3ZXN0IGl0ZW0gaXMgYWx3YXlzXG5cdFx0ICogcGVyc2lzdGVkIGFzIHRoZSBsYXN0IGluIHRoZSBkYXRhYmFzZSBpZiBubyBVWCByZW9yZGVycyB0aGUgaXRlbVxuXHRcdCAqXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMudXBkYXRlX3BsYW5fb3JkZXJzID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdCQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYWNjZXNzLXBsYW4nICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0dmFyICRwID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdCRvcmRlciA9ICRwLmZpbmQoICcucGxhbi1vcmRlcicgKSxcblx0XHRcdFx0XHQkZWRpdG9yID0gJHAuZmluZCggJ3RleHRhcmVhW2lkXj1cIl9sbG1zX3BsYW5zX2NvbnRlbnRfXCJdJyApLFxuXHRcdFx0XHRcdGVkaXRvcl9pZCA9ICRlZGl0b3IuYXR0ciggJ2lkJyApLFxuXHRcdFx0XHRcdG9yaWcgPSAkb3JkZXIudmFsKCkgKiAxLFxuXHRcdFx0XHRcdGN1cnIgPSAkcC5pbmRleCgpO1xuXG5cdFx0XHRcdC8vIGRlLWluaXQgdGlueU1DRSBmcm9tIHRoZSBlZGl0b3Jcblx0XHRcdFx0dGlueU1DRS5FZGl0b3JNYW5hZ2VyLmV4ZWNDb21tYW5kKCAnbWNlUmVtb3ZlRWRpdG9yJywgdHJ1ZSwgZWRpdG9yX2lkICk7XG5cblx0XHRcdFx0Ly8gdXBkYXRlIHRoZSBvcmRlciBvZiBlYWNoIGZpZWxkIGluIHRoZSBwbGFuXG5cdFx0XHRcdCRwLmZpbmQoICdzZWxlY3QsIGlucHV0LCB0ZXh0YXJlYScgKS5lYWNoKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHRcdHZhciBuYW1lID0gJCggdGhpcyApLmF0dHIoICduYW1lJyApO1xuXHRcdFx0XHRcdGlmICggbmFtZSApIHtcblx0XHRcdFx0XHRcdCQoIHRoaXMgKS5hdHRyKCAnbmFtZScsIG5hbWUucmVwbGFjZSggb3JpZywgY3VyciApICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0XHQvLyByZS1pbml0IHRpbnlNQ0Ugb24gdGhlIGVkaXRvclxuXHRcdFx0XHR0aW55TUNFLkVkaXRvck1hbmFnZXIuZXhlY0NvbW1hbmQoICdtY2VBZGRFZGl0b3InLCB0cnVlLCBlZGl0b3JfaWQgKTtcblxuXHRcdFx0XHQkb3JkZXIudmFsKCBjdXJyICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdH07XG5cblx0XHQvLyBnb1xuXHRcdHRoaXMuaW5pdCgpO1xuXG5cdH07XG5cblx0dmFyIGEgPSBuZXcgd2luZG93LmxsbXMubWV0YWJveF9wcm9kdWN0KCk7XG5cbn0gKSggalF1ZXJ5ICk7XG4iXX0=
